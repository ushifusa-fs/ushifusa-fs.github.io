!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){if(void 0===n){!function(){i(1);var t=i(2),e={1:{w:320,h:50,reload:!0,expand:!1},10:{w:320,h:250,reload:!1,expand:!1},80:{w:320,h:180,reload:!1,expand:!0,full:!0},90:{w:320,h:50,reload:!0,expand:!1},100:{w:320,h:100,reload:!0,expand:!1},160:{w:320,h:180,reload:!0,expand:!1}},n=5,o=10,a=11,s=0,r=function(){return JSON.parse("${AD_RESULT}")},d={getResult:function(){return JSON.parse("${VIDEO_RESULT}")}},h={};function l(e){var i;this.playerType=void 0!==e.playerType?e.playerType:"sprite",this.conf=d.getResult();var n=this;if(this.richSquareObj=null,void 0!==p.extPlayerArgs[e.adUnitId]&&void 0!==p.extPlayerArgs[e.adUnitId].extend&&(this.conf.data=p.extPlayerArgs[e.adUnitId].extend.data),void 0!==this.conf.aRatio?this.aspectRatio=this.conf.aRatio:this.aspectRatio=l.aspectRatio.WIDE,this.conf.adContentType==a?(e.playerHeight=this.conf.height,e.id="admatrixRichSquare-"+e.adUnitId,e.tagManageParam.hasProgressBar=!0,void 0!==document.fullscreenEnabled?e.tagManageParam.denyFullscreen=!document.fullscreenEnabled:e.tagManageParam.denyFullscreen=!1,this.richSquareObj=new AdmatrixRichSquare(e),this.richSquareObj.addEvent("click",(function(){n.downloadButton.click()})),i=this.richSquareObj.getPlayerContainerWithId(t.NAMESPACE+"Video-"+e.adUnitId)):(i=document.getElementById(t.NAMESPACE+"Video-"+e.adUnitId),void 0!==document.fullscreenEnabled&&(e.tagManageParam.denyFullscreen=!document.fullscreenEnabled)),i){switch(i.className=i.className+" admatrixVideoUnit",this.parentEl=i,this.clickMacro=null,this.loading=!0,this.playing=!1,this.started=!1,this.isVisible=!1,this.paused=!1,this.fullscreenTarget=!1,this.adEvent={},this.amdSent=!1,this.trackingSent={1:!1,25:!1,50:!1,75:!1,100:!1},this.interval=0,this.impSent=!1,this.playEnded=!1,this.images=[],this.playTime=0,this.frameIndex=0,this.frameIndexTotal=0,this.sheetNo=1,this.readySheetNoMax=0,this.loadingSheetNoMax=0,this.audio=null,this.sound=!1,this.thirdPartyTracking={},this.callback={},this.autoReplayCount=0,this.hasInteractiveButton=!1,this.visibilityWhenScrollStart=null,this.clickMode=l.clickMode.LANDING_PAGE,this.defaultClickMode=l.clickMode.LANDING_PAGE,this.detailButtonShown=!1,this.finishedOnce=!1,this.openPartialAdvisedFlag=!1,this.relayVastEvent=!0,this.relayVpaidEvent=!0,void 0!==this.conf.extendContent&&""!=this.conf.extendContent&&null!=this.conf.extendContent&&(void 0!==e.tagManageParam.videoClickMode?(this.clickMode=e.tagManageParam.videoClickMode,this.defaultClickMode=e.tagManageParam.videoClickMode):(this.clickMode=l.clickMode.EVENT,this.defaultClickMode=l.clickMode.EVENT)),this.playerType){case"sprite":this.interval=1/this.conf.fps,this.init(),this.appendCommonEl(),this.showLoadImage(),this.startLoad()}return this}p.passError&&p.passError(e.adUnitId,"can not find movie container")}function c(t,e,i,o,a){if(i=i||{},this.impSent=!1,this.renderSent=!1,this.needRenderSend=!1,this.shown=!1,this.adUnitId=i.adUnitId,this.adId=e.adId,this.containerId=null,this.defaultOffsetY=null,this.overlayTopMargin=0,this.staticOffset=!1,this.overlayZindex=4999,this.admatrixAdMediation=null,this.slideDownObj=null,this.options=i,void 0===this.options.alt&&(this.options.alt=!1),void 0===this.options.clickMacro&&(this.options.clickMacro=""),void 0===this.options.expandable&&(this.options.expandable=!0),void 0===this.options.overlay&&(this.options.overlay=0),void 0===this.options.safeFrame&&(this.options.safeFrame=!1),void 0===this.options.inFrame&&(this.options.inFrame=!1),void 0===this.options.keepSizeWhenPassBack&&(this.options.keepSizeWhenPassBack=!1),void 0===this.options.tagmp&&(this.options.tagmp={}),void 0===this.options.tagmp.overlayAlways&&(this.options.tagmp.overlayAlways=!1),void 0===this.options.tagmp.overlayAutoClose&&(this.options.tagmp.overlayAutoClose=!1),this.el=t,this.ad=e,this.trnId=e.trnId,this.onError=null,this.busterReady=!1,this.player=null,this.vast=!1,this.vastPlayerReady=!1,this.adnwUnitId=null,this.parentWidth=0,this.parentHeight=0,this.scrollPassThrough=!1,this.visibilityWhenScrollStart=null,this.visibility=null,this.visibilityWhenScrollEnd=null,this.adUnitPosition=void 0!==i.position?i.position:null,void 0!==o&&(this.onError=o),void 0!==a&&(this.onDestroySelf=a),void 0!==p.overlayParam[this.adUnitId]){var s=p.overlayParam[this.adUnitId];void 0!==s.topMargin&&(this.overlayTopMargin=s.topMargin),void 0!==s.offsetTop&&(this.defaultOffsetY=s.offsetTop,this.staticOffset=!0),void 0!==s.zIndex&&(this.overlayZindex=s.zIndex)}(p.amp||this.ad.acttt!=n||this.options.overlay&&this.options.safeFrame)&&(this.options.overlay=!1,this.options.tagmp.overlayAlways=!1),this.empty(),this.options.hasBuster&&(this.frameId=this.options.frameId,this.initBuster())}"function"==typeof window.addEventListener?h.addEl=function(t,e,i){t&&t.addEventListener&&t.addEventListener(e,i,!1)}:"function"==typeof document.attachEvent?h.addEl=function(t,e,i){t&&t.attachEvent&&t.attachEvent("on"+e,i)}:h.addEl=function(t,e,i){t&&(t["on"+e]=i)},"function"==typeof window.removeEventListener?h.rmEl=function(t,e,i){t&&t.removeEventListener&&t.removeEventListener(e,i,!1)}:"function"==typeof document.detachEvent?h.rmEl=function(t,e,i){t&&t.detachEvent&&t.detachEvent("on"+e,i)}:h.rmEl=function(t,e,i){t&&(t["on"+e]=null)},h.fireEv=function(t,e){if(document.createEvent){if(!t)return;return(i=document.createEvent("HTMLEvents")).initEvent(e,!0,!0),t.dispatchEvent(i)}if(t){var i=document.createEventObject();return t.fireEvent("on"+e,i)}},h.mkUrl=function(t,e){var i="";return e=e||{},Object.keys(e).forEach((function(t){var e=this[t];if(""!=i&&(i+="&"),Array.isArray(e)){for(var n="",o=0;o<e.length;o++)""!=n&&(n+="&"),n+=t+"[]="+e[o];i+=n}else i+=t+"="+e}),e),t+"?"+i},h.osSupported=function(){var t=window.navigator.userAgent.toLowerCase();return/android|iphone|ipod|ipad/i.test(t)},h.isSafari=function(){var t=window.navigator.userAgent.toLowerCase();return/safari/i.test(t)},h.isIOS=function(){var t=window.navigator.userAgent.toLowerCase();return/iphone|ipod|ipad/i.test(t)},h.getIosVersion=function(){var t=h.iosVerStr();if(!t)return 0;try{return t=parseInt(t.replace(/\./g,"")),isNaN(t)&&(t=0),t}catch(t){return 0}},h.iosVerStr=function(){var t=window.navigator.userAgent,e=t.indexOf("OS");if(e<0)return!1;for(var i=t.substring(e+2),n=i.length,o="",a=0;a<n-1&&!(0<a&&" "==i[a]);a++)!isFinite(i[a])&&"_"!=i[a]||(o+=""+i[a]);return 2==(o=o.trim()).split("_").length&&(o+="_0"),o.replace(/_/g,".")},h.isAndroidBrowser=function(){try{var t=window.navigator.userAgent;if(/Android/.test(t)&&/Linux; U;/.test(t)&&!/Chrome/.test(t))return!0}catch(t){return!1}return!1},h.getChromeVersion=function(){try{var t=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!t&&parseInt(t[2],10)}catch(t){return!1}},h.getAndroidVersion=function(){try{if(0<navigator.userAgent.indexOf("Android"))return parseFloat(navigator.userAgent.slice(navigator.userAgent.indexOf("Android")+8))}catch(t){}return!1},h.proxy=function(t,e){var i=[].slice.call(arguments,2);return function(){return t.apply(e,i.concat([].slice.call(arguments)))}},h.strToCssColor=function(t){return t},h.getVisibility=function(t,e){if(t){if(e=e||{},"0"==t.style.width||"0"==t.style.height)return!1;var i=document,n=i.getElementsByTagName("HTML")[0].style.getPropertyValue("zoom"),o=1;n&&(/^[\d\.]+%$/.test(n)?o=parseFloat(n.replace("%",""))/100:/^[\d\.]+$/.test(n)&&(o=parseFloat(n)));var a=0,s=0;if(void 0!==e&&void 0!==e.scrollParent)try{var r=i.getElementById(e.scrollParent);r&&(a=r.scrollLeft,s=r.scrollTop)}catch(t){}else a=void 0!==window.pageXOffset?window.pageXOffset:(i.documentElement||i.body.parentNode||i.body).scrollLeft,s=void 0!==window.pageYOffset?window.pageYOffset:(i.documentElement||i.body.parentNode||i.body).scrollTop;var d=h.getWindowHeight(),l=window.innerWidth,c=t.offsetHeight*o,p=t.offsetWidth*o;void 0===e.offsetTop&&(e.offsetTop=0);for(var u=0,f=0;u+=t.offsetTop||0,f+=t.offsetLeft||0,t=t.offsetParent;);return u*=o,f*=o,s+e.offsetTop>u+.5*c?"BELOW":u+.5*c>s+d+e.offsetTop?"ABOVE":f+.5*p<a?"RIGHT":a+l<f+.5*p?"LEFT":"VISIBLE"}},h.getVisibilityByIntersectionObserver=function(t){var e=t.getElement();new IntersectionObserver((function(e){e.forEach((function(e){return e.isIntersecting&&.1<=e.intersectionRatio||1==t.player.conf.startBy?(t.onVisible(),"VISIBLE"):(t.offVisible(),"BELOW")}))}),{rootMargin:"0px",threshold:[.1,.2,.3,.4,.5,.6,.7,.8,.9,1]}).observe(e)},h.replaceBr=function(t){return null==t?"":t.replace(/\r?\n/g,"<br>")},h.isFullScreen=function(){return null!=(document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.fullscreenElement)},h.isVastSupported=function(){var t=!0;return h.isIOS()?h.getIosVersion()<900&&(t=!1):h.getAndroidVersion()<5?4<=h.getAndroidVersion()&&50<=h.getChromeVersion()||(t=!1):(h.getChromeVersion()<50||h.isAndroidBrowser())&&(t=!1),t},h.getOrientation=function(){return window.innerWidth>h.getWindowHeight()?"landscape":"portrait"},h.getWindowHeight=function(t){if(void 0===t&&(t=window),t.innerHeight!==t.document.documentElement.clientHeight)return t.innerHeight>t.document.documentElement.clientHeight?t.innerHeight:t.document.documentElement.clientHeight;if(h.isIOS())return t.innerHeight;var e=h.getScreenHeight(t);return t.innerHeight<e?e:t.innerHeight},h.getScreenHeight=function(t){return t.innerHeight>t.innerWidth?t.screen.height>t.screen.width?t.screen.height:t.screen.width:t.screen.height<t.screen.width?t.screen.height:t.screen.width},h.isSupportInlineMovie=function(){return h.isIOS()&&1e3<=h.getIosVersion()||!h.isIOS()&&5<=h.getAndroidVersion()&&53<=h.getChromeVersion()},h.replaceHttp=function(){"https:"==location.protocol&&(t.BASE_URL=t.BASE_URL.replace("http:","https:"),t.BASE_API_URL=t.BASE_API_URL.replace("http:","https:"),t.BASE_STATIC_URL=t.BASE_STATIC_URL.replace("http:","https:"))},h.replaceHttp(),l.trackableEvents=["repeat","mute","unmute","pause","play","resume"],l.clickMode={LANDING_PAGE:0,EVENT:1},l.aspectRatio={WIDE:"16:9",RECT:"4:3"},l.prototype.appendCommonEl=function(){var e=document,i=this,n=e.createElement("div");n.setAttribute("style","position: absolute; top: -9999px; left: -9999px; opacity: 1; overflow: hidden; width: 0; height: 0; z-index: 0;"),this.beacon=n,this.container.appendChild(n);var o=e.createElement("div");o.setAttribute("style","position: absolute; cursor: pointer; width: 25px; height: 25px; bottom: 32px; left: 7px; display: none; z-index: 5; margin: 0; padding: 0;");var s=e.createElement("img");s.src=t.BASE_STATIC_URL+"img/icon_fullscreen.png",s.setAttribute("style","position: absolute; width: 18px; height: 18px; margin: 0; padding: 0; bottom: 0; left: 0;"),o.appendChild(s),this.conf.adContentType==a&&(o.style.bottom="5px",o.style.right="5px",o.style.left="auto",o.style.top="auto",s.style.left="auto",s.style.right="0"),o.onclick=function(t){t.stopPropagation(),i.fullscreenTarget=!0,i.playFullScreen()},this.fullscreenButton=o,this.container.appendChild(o);var r=e.createElement("img");if(r.src=t.BASE_STATIC_URL+"img/icon_close.png",r.setAttribute("style","position: absolute; cursor: pointer; width: 25px; height: 25px; display: none; z-index: 5; margin: 0; padding: 0;"),this.conf.tagManageParam&&void 0!==this.conf.tagManageParam.closeButtonPosition)switch(this.conf.tagManageParam.closeButtonPosition){case"topRight":r.style.top="5px",r.style.right="5px";break;default:r.style.bottom="5px",r.style.right="5px"}else r.style.bottom="5px",r.style.right="5px";r.onclick=function(e){e.stopPropagation(),i.overlay?i.sendMessage({type:t.NAMESPACE+"-player-close-overlay",adUnitId:i.conf.adUnitId,frameId:i.conf.frameId}):i.sendMessage({type:t.NAMESPACE+"-player-abort",adUnitId:i.conf.adUnitId,frameId:i.conf.frameId})},this.conf.tagManageParam&&void 0!==this.conf.tagManageParam.hasCloseButton&&this.conf.tagManageParam.hasCloseButton?r.style.display="block":r.style.display="none",this.closeButton=r,this.container.appendChild(r)},l.prototype.execCallback=function(t){void 0!==this.callback[t]&&this.callback[t]()},l.prototype.scrollStart=function(t){this.visibilityWhenScrollStart=t,void 0!==this.showInteractiveButtonTimeout&&(clearTimeout(this.showInteractiveButtonTimeout),this.showInteractiveButtonTimeout=void 0),this.cancelDetailButtonTimeout(),this.visibilityWhenScrollEnd=null},l.prototype.cancelDetailButtonTimeout=function(){void 0!==this.detailButtonTimeout&&(clearTimeout(this.detailButtonTimeout),this.detailButtonTimeout=void 0)},l.prototype.scrollEnd=function(t,e){this.visibilityWhenScrollEnd=t,e?(this.hideDetailButton(),this.showInteractiveButton()):"VISIBLE"==t&&this.setDetailButtonTimeout()},l.prototype.setDetailButtonTimeout=function(){if(void 0===this.detailButtonTimeout&&this.detailButton){var t=this;this.detailButtonTimeout=setTimeout((function(){t.showDetailButton()}),SLIDE_DOWN_SHOW_DETAIL_BTN_TIMEOUT)}},l.prototype.showDetailButton=function(){this.interactiveMode||(this.detailButtonTimeout=void 0,this.playing&&(this.redirectOverlay&&(this.downloadButton.style.display="none",this.redirectOverlay.style.display="block"),this.detailButton.style.display="block",this.execCallback("detailButtonShown"),this.detailButtonShown=!0))},l.prototype.hideDetailButton=function(){this.cancelDetailButtonTimeout(),this.detailButton&&(this.detailButton.style.display="none"),this.redirectOverlay&&(this.downloadButton.style.display="block",this.redirectOverlay.style.display="none"),this.execCallback("detailButtonHide"),this.detailButtonShown=!1},l.prototype.init=function(){var e=this,i=document;this.useMovieFile=!0;var n=i.createElement("div");n.setAttribute("style","position: relative; width:"+this.conf.width+"px; height: "+this.conf.height+"px; margin: 0 auto; padding: 0; -webkit-tap-highlight-color: rgba(0,0,0,0); overflow: hidden; background-color: #000; transform: translate3d(0, 0, 0);"),this.container=n,this.parentEl.appendChild(n);var o=i.createElement("img");o.src=this.conf.thumbFile,o.setAttribute("style","width: "+this.conf.width+"px; height: "+this.conf.height+"px; margin-top: 0; margin-left: 0; padding: 0; -webkit-tap-highlight-color: rgba(0,0,0,0);"),this.thumbnail=o,n.appendChild(o);var a=i.createElement("div");a.setAttribute("style","position: absolute; width: "+this.conf.width+"px; max-width: "+this.conf.width+"px; height: "+this.conf.height+"px; left: 0; top: 0; display: none; z-index: 0; -webkit-tap-highlight-color: rgba(0,0,0,0);"),this.lookWindow=a,this.container.appendChild(a);var s=i.createElement("div");s.setAttribute("style","position: absolute; width: "+this.conf.width+"px; height: "+this.conf.height+"px; margin: 0; padding: 0; -webkit-tap-highlight-color: rgba(0,0,0,0); z-index: 1; left: 0; top: 0; display: none; background: transparent; cursor: pointer;"),this.movieOverlay=s;var r=i.createElement("a");if(r.setAttribute("style","cursor: pointer; position: absolute; margin: 0 auto; padding: 0; width: "+this.conf.width+"px; height: "+this.conf.height+"px; top: 0; left: 0; display: block; z-index: 3; border: none; background: transparent;"),this.conf.safeFrame&&h.isIOS()&&1e3<=h.getIosVersion()&&1==this.conf.lpType||!h.isIOS()&&2==this.conf.lpType?r.target="_top":(r.target="_blank",r.setAttribute("rel","noopener")),r.href=this.conf.clickUrl,r.onclick=function(t){if(e.clickMode==l.clickMode.EVENT)t.preventDefault(),e.execCallback("click");else{e.playEnded||e.toggleAudio(!1,!1);var i=e.downloadButton.href+"&t="+e.playTime+"&rp="+(e.finishedOnce?"1":"0");e.clickMacro&&(i=e.clickMacro+encodeURIComponent(i)),e.downloadButton.href=i}},this.downloadButton=r,s.appendChild(r),void 0!==this.conf.extendContent&&""!=this.conf.extendContent){var d=i.createElement("a");d.setAttribute("style","cursor: pointer; position: absolute; margin: 0 auto; padding: 0; width: "+this.conf.width+"px; height: "+this.conf.height+"px; top: 0; left: 0; display: block; z-index: 4; border: none; background: transparent;"),this.conf.safeFrame&&h.isIOS()&&1e3<=h.getIosVersion()&&1==this.conf.lpType||!h.isIOS()&&2==this.conf.lpType?d.target="_top":(d.target="_blank",d.setAttribute("rel","noopener")),d.href=this.conf.clickUrl,d.onclick=function(t){e.playEnded||e.toggleAudio(!1,!1);var i=e.conf.clickUrl+"&t="+e.playTime+"&rp="+(e.finishedOnce?"1":"0");e.clickMacro&&(i=e.clickMacro+encodeURIComponent(i)),e.redirectOverlay.href=i},d.style.display="none",this.redirectOverlay=d,s.appendChild(d)}var c=i.createElement("img");c.src=t.BASE_STATIC_URL+"img/icon_repeat.png",c.setAttribute("style","position: absolute; cursor: pointer; width: 25px; height: 25px; top: 5px; left: 5px; display: none; z-index: 5; margin: 0; padding: 0;"),c.onclick=function(t){t.stopPropagation(),e.replay(!0)},this.loopButton=c,s.appendChild(c),this.conf.sound||(this.conf.tagManageParam.hasSoundButton=!1);var p=i.createElement("div");p.setAttribute("style","position: absolute; cursor: pointer; width: 25px; height: 25px; bottom: 5px; left: 5px; display: none; z-index: 5; margin: 0; padding: 0; overflow: hidden;");var u=i.createElement("img");u.src=t.BASE_STATIC_URL+"img/icon_sound_off_v2.png",u.setAttribute("style","position: absolute; cursor: pointer; width: 18px; height: 18px; bottom: 0; left: 0; margin: 0; padding: 0; display: block;"),p.appendChild(u),p.onclick=function(t){t.stopPropagation(),e.toggleAudio(!0)},this.soundOnButton=p,s.appendChild(p);var f=i.createElement("div");f.setAttribute("style","position: absolute; cursor: pointer; width: 25px; height: 25px; bottom: 5px; left: 5px; display: none; z-index: 5; margin: 0; padding: 0; overflow: hidden");var m=i.createElement("img");m.src=t.BASE_STATIC_URL+"img/icon_sound_on_v2.png",m.setAttribute("style","position: absolute; cursor: pointer; width: 18px; height: 18px; bottom: 0; left: 0; display: block; margin: 0; padding: 0;"),f.appendChild(m),f.onclick=function(t){t.stopPropagation(),e.toggleAudio(!1)},this.soundOffButton=f,s.appendChild(f),this.container.appendChild(s),this.createLastPage()},l.prototype.addDetailButton=function(t){var e=document.createElement("a");e.setAttribute("style","display: none; position: absolute; right: 5px; bottom: 5px; padding: 5px 8px; text-decoration: none; font-size: 10px; color: "+h.strToCssColor(t.color)+"; background: "+h.strToCssColor(t.bgColor)+"; border: none; border-radius: 4px; opacity: 0.9;"),e.href=t.clickUrl,this.conf.safeFrame&&h.isIOS()&&1e3<=h.getIosVersion()&&1==t.lpType||!h.isIOS()&&2==t.lpType?e.target="_top":(e.target="_blank",e.setAttribute("rel","noopener")),e.innerHTML=t.textBody,this.detailButton=e,this.movieOverlay?this.movieOverlay.appendChild(e):this.container.appendChild(e)},l.prototype.setClickMode=function(t){this.clickMode=t,this.defaultClickMode=t},l.prototype.playFullScreen=function(){this.pause(),this.showFullScreenVideo(),this.videoPlay()},l.prototype.showLoadImage=function(){if(!this.loadImage){var t=document.createElement("div");t.className="admatrix-loadingOverlay loading",t.setAttribute("style","display: none; width: "+this.conf.width+"px; height: "+this.conf.height+"px; left: 0; top: 0; padding: 0; -webkit-tap-highlight-color: rgba(0,0,0,0);"),this.container.appendChild(t),this.loadImage=t}this.loadImage.style.display="block"},l.prototype.hideLoadImage=function(){this.loadImage&&(this.loadImage.style.display="none")},l.prototype.createLastPage=function(){var e=this,i=document.createElement("div");i.className="admatrix-lastPageOverlay",i.setAttribute("style","display: none; width: "+this.conf.width+"px; height: "+this.conf.height+"px; left: 0; top: 0; padding: 0; -webkit-tap-highlight-color: rgba(0,0,0,0);");var n=document.createElement("div");n.setAttribute("style","display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100%;");var o=document.createElement("div"),a=document.createElement("a");a.target="_blank",a.href=this.conf.clickUrl,a.setAttribute("style","cursor: pointer;");var s=document.createElement("div"),r=document.createElement("img");r.src=t.BASE_STATIC_URL+"img/information_icon_v2.png",r.setAttribute("style","float: left; width: 40px; height: 40px;");var d=document.createElement("div");d.insertAdjacentHTML("afterbegin","詳しくはこちら"),d.setAttribute("style","margin-top: 10px; float: left; font-size: 14px;");var h=document.createElement("div"),l=document.createElement("a");l.href="javascript:void(0);",l.onclick=function(t){t.stopPropagation(),e.replay(!0)},l.setAttribute("style","cursor: pointer;");var c=document.createElement("div"),p=document.createElement("img");p.src=t.BASE_STATIC_URL+"img/icon_repeat.png",p.setAttribute("style","float: left; width: 40px; height: 40px;");var u=document.createElement("div");u.insertAdjacentHTML("afterbegin","動画をリプレイ"),u.setAttribute("style","margin-top: 10px; float: left; font-size: 14px;"),s.appendChild(r),s.appendChild(d),a.appendChild(s),o.appendChild(a),n.appendChild(o),c.appendChild(p),c.appendChild(u),l.appendChild(c),h.appendChild(l),n.appendChild(h),i.appendChild(n),this.container.appendChild(i),this.lastPage=i},l.prototype.showLastPage=function(){this.lastPage.style.display="block"},l.prototype.hideLastPage=function(){this.lastPage.style.display="none"},l.prototype.startLoad=function(){this.loadMovieFile()},l.prototype.loadMovieFile=function(){this.useMovieFile?this.localVideoForMovieFile():(this.loadVideoForSprite(),this.getSheet(this.readySheetNoMax+1))},l.prototype.loadVideoForSprite=function(){var t=this;if(this.conf.tagManageParam&&void 0!==this.conf.tagManageParam.denyFullscreen&&this.conf.tagManageParam.denyFullscreen)this.video=null;else{var e=document.createElement("video"),i=document.createElement("source");i.src=this.conf.movieFile,i.type="video/mp4",e.appendChild(i),e.preload="metadata",e.style.position="absolute",e.style.top="0",e.style.left="-9999px",e.style.zIndex=0,e.muted=!0,h.addEl(e,"ended",(function(){t.endFullScreenVideo()})),h.addEl(e,"timeupdate",(function(){t.progressFullScreenVideo()})),h.addEl(e,"error",(function(){t.conf.tagManageParam.denyFullscreen=!0})),h.isIOS()&&(h.addEl(e,"webkitbeginfullscreen",(function(){t.fullScreenChanged(!0)})),h.addEl(e,"webkitendfullscreen",(function(){t.fullScreenChanged(!1)}))),this.beacon.appendChild(e),this.video=e}if(this.conf.tagManageParam&&void 0!==this.conf.tagManageParam.hasSoundButton&&this.conf.tagManageParam.hasSoundButton){var n=new Audio;n.src=this.conf.movieFile,n.preload="metadata",n.muted=!0,n.load(),this.audio=n}},l.prototype.localVideoForMovieFile=function(){var t=this,e=document.createElement("video"),i=document.createElement("source");if(11===this.conf.adType){i=(e=document.getElementById("admatrixOLV")).getElementsByTagName("source")[0];var n=document.getElementById("admatrixOLVOverlayText"),o=document.getElementById("admatrixOLVBannerWrapper")}e.setAttribute("playsinline",""),e.setAttribute("webkit-playsinline",""),e.width=this.conf.width,e.height=this.conf.height,i.src=this.conf.movieFile,i.type="video/mp4",e.appendChild(i),e.preload="metadata",e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.zIndex=0,e.style.width=this.conf.width+"px",e.style.height=this.conf.height+"px",e.muted=!0,e.loop=!1,h.addEl(e,"loadedmetadata",(function(){t.handleVideoLoadedmetadata()})),h.addEl(e,"ended",(function(){t.handleVideoEnded()})),h.addEl(e,"timeupdate",(function(){t.handleVideoTimeUpdate()})),h.addEl(e,"error",(function(){t.handleVideoLoadError()})),h.addEl(e,"canplaythrough",(function(){t.handleVideoCanPlayThrough()})),h.addEl(e,"canplay",(function(){t.handleVideoCanPlay()})),this.lookWindow.appendChild(e),11===this.conf.adType&&(this.lookWindow.appendChild(n),this.lookWindow.appendChild(o)),this.video=e,this.videoLoadTimeout=setTimeout((function(){t.checkVideoLoad()}),200)},l.prototype.handleVideoLoadedmetadata=function(){this.conf.duration=this.video.duration},l.prototype.checkVideoLoad=function(){if(clearTimeout(this.videoLoadTimeout),this.videoLoadTimeout=void 0,1<=this.video.readyState)return this.sheetNo=this.conf.sheets,this.readySheetNoMax=this.sheetNo,void(this.loading=!1);var t=this;this.videoLoadTimeout=setTimeout((function(){t.checkVideoLoad()}),200)},l.prototype.handleVideoEnded=function(){this.playTime=this.video.duration,this.finish()},l.prototype.handleVideoTimeUpdate=function(){this.playTime=this.video.currentTime;var t=this.playTime,e=this;setTimeout((function(){e.handleTimeEvent(t)}),0)},l.prototype.handleVideoLoadError=function(){},l.prototype.handleVideoCanPlayThrough=function(){clearTimeout(this.videoLoadTimeout),this.videoLoadTimeout=void 0,this.sheetNo=this.conf.sheets,this.readySheetNoMax=this.sheetNo,this.loading=!1},l.prototype.handleVideoCanPlay=function(){},l.prototype.toggleAudio=function(t,e){this.conf.sound&&(this.useMovieFile||this.audio)&&(void 0===e&&(e=!0),t?(this.soundOnButton.style.display="none",this.soundOffButton.style.display="block",this.useMovieFile?this.video.muted=!1:(this.audio.currentTime=this.playTime,this.audio.muted=!1,this.audio.play()),e&&this.handleEvent("unmute")):(this.soundOnButton.style.display="block",this.soundOffButton.style.display="none",this.useMovieFile?this.video.muted=!0:(this.audio.pause(),this.audio.muted=!0),e&&this.handleEvent("mute")),this.sound=t)},l.prototype.getSheet=function(t,e){if(!(t>this.conf.sheets)){var i=this.conf.imageFile.replace(/\{index\}/g,("0000"+t).slice(-5)),n=document.createElement("img");n.src=i;var o=this.conf.height*this.conf.frames*(t-1);o=0<o?o+"px":o,n.setAttribute("style","position: absolute; top: "+o+"; left: 0; width: "+this.conf.width+"px; max-width: "+this.conf.width+"px; height: auto; margin: 0; padding: 0; z-index: -1; display: block; -webkit-tap-highlight-color: rgba(0,0,0,0);");var a=this;this.lookWindow,n.onload=function(){t>a.readySheetNoMax&&(a.readySheetNoMax=t),e?setTimeout((function(){a.play()}),100):a.readySheetNoMax>=a.conf.sheets/5&&(a.loading=!1,a.loadingSheetNoMax<a.conf.sheets&&(a.loadingSheetNoMax+=1,a.getSheet(a.loadingSheetNoMax,!1)))},this.images.push(n),this.lookWindow.appendChild(n),t<this.conf.sheets&&t<=this.conf.sheets/4&&setTimeout((function(){a.loadingSheetNoMax=t+1,a.getSheet(t+1,!1)}),200)}},l.prototype.visible=function(){var t=this;if(this.isVisible=!0,!this.animating)if(this.loading||"interactive"!=document.readyState&&"complete"!=document.readyState)this.loadingTimeout=setTimeout((function(){t.visible()}),100);else if(!this.playing&&!this.playEnded)switch(void 0!==this.loadingTimeout&&(clearTimeout(this.loadingTimeout),this.loadingTimeout=void 0),this.playerType){case"sprite":if(this.started){if(this.resumeTimeout)return;this.resume()}else{if(this.playTimeout)return;this.play()}}},l.prototype.hidden=function(){if(this.isVisible=!1,!(this.animating||(void 0!==this.loadingTimeout&&(clearTimeout(this.loadingTimeout),this.loadingTimeout=void 0),this.cancelDetailButtonTimeout(),void 0!==this.showInteractiveButtonTimeout&&(clearTimeout(this.showInteractiveButtonTimeout),this.showInteractiveButtonTimeout=void 0),this.hideInteractiveButton(),void 0!==this.playTimeout&&(clearTimeout(this.playTimeout),this.playTimeout=void 0),void 0!==this.resumeTimeout&&(clearTimeout(this.resumeTimeout),this.resumeTimeout=void 0),this.loading||this.playEnded||this.paused)))switch(this.playerType){case"sprite":this.pause()}},l.prototype.play=function(e){var i=this;if(e=e||!1,this.loading||"interactive"!=document.readyState&&"complete"!=document.readyState)this.playTimeout=setTimeout((function(){i.play()}),100);else if(!this.useMovieFile&&this.readySheetNoMax<=this.sheetNo&&this.sheetNo<this.conf.sheets)this.playTimeout=setTimeout((function(){i.play()}),100);else{void 0!==this.playTimeout&&(clearTimeout(this.playTimeout),this.playTimeout=void 0),this.started=!0,this.movieOverlay.style.display="block",this.conf.tagManageParam&&void 0!==this.conf.tagManageParam.hasSoundButton&&this.conf.tagManageParam.hasSoundButton&&(this.sound?(this.soundOnButton.style.display="none",this.soundOffButton.style.display="block"):(this.soundOnButton.style.display="block",this.soundOffButton.style.display="none")),this.conf.tagManageParam&&void 0!==this.conf.tagManageParam.denyFullscreen&&this.conf.tagManageParam.denyFullscreen?this.fullscreenButton.style.display="none":this.fullscreenButton.style.display="block",this.loopButton.style.display="none";var n="translate(0, 0)",o=this.lookWindow;o.style.transform=n,o.style.webkitTransform=n,o.style.MozTransform=n,o.style.msTransform=n,o.style.OTransform=n,o.style.display="block",this.loadImage.style.display="none",this.thumbnail.style.display="none",this.playTime=this.interval,this.progressValue=this.interval,this.progressBar(this.interval),void 0===this.intervalId&&(this.playing=!0,this.handleEvent("play"),this.richSquareObj&&this.richSquareObj.start(),this.useMovieFile?this.video.play():(this.images[this.sheetNo-1].style.display="block",this.intervalId=setInterval((function(){i.next()}),1e3*this.interval)),this.progressElem&&(this.progressInterval=setInterval((function(){i.progressValue+=i.interval/2,i.progressBar(i.progressValue)}),this.interval/2*1e3)),e&&this.toggleAudio(this.sound,!1),null==this.visibilityWhenScrollStart&&this.setDetailButtonTimeout(),this.sendMessage({type:t.NAMESPACE+"-player-play-started",adUnitId:this.conf.adUnitId,frameId:this.conf.frameId}))}},l.prototype.progressBar=function(t){this.progressElem&&(this.progressElem.style.width=t/this.conf.duration*100+"%")},l.prototype.next=function(){var t=this;if(this.readySheetNoMax<this.conf.sheets&&(this.frameIndexTotal+1)/this.conf.frames>this.readySheetNoMax)return this.pause(),void setTimeout((function(){t.resume()}),300);if(this.frameIndex+1==this.conf.frames?(this.sheetNo+=1,this.frameIndex=-1):this.frameIndex+=1,this.images.length<this.sheetNo)this.finish();else{this.frameIndexTotal+=1;var e="translate(0, -"+this.frameIndexTotal*this.conf.height+"px)",i=this.lookWindow;if(i.style.transform=e,i.style.webkitTransform=e,i.style.MozTransform=e,i.style.msTransform=e,i.style.OTransform=e,this.playTime+=this.interval,this.frameIndexTotal!=this.conf.totalFrames-1){var n=this.playTime;setTimeout((function(){t.handleTimeEvent(n)}),0)}else this.finish()}},l.prototype.pause=function(){if(this.playing&&!this.playEnded)switch(void 0!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),void 0!==this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=void 0),this.richSquareObj&&this.richSquareObj.stop(),this.playing=!1,this.paused=!0,this.playerType){case"sprite":this.useMovieFile?(this.video.pause(),this.sound&&(this.video.muted=!1)):this.sound&&(this.audio.muted=!0,this.audio.pause()),this.handleEvent("pause")}},l.prototype.resume=function(){var t=this;if(this.isVisible&&!this.playEnded&&void 0===this.intervalId)if(!this.useMovieFile&&this.readySheetNoMax<=this.sheetNo&&this.sheetNo<this.conf.sheets)this.resumeTimeout=setTimeout((function(){t.resume()}),100);else switch(void 0!==this.resumeTimeout&&(clearTimeout(this.resumeTimeout),this.resumeTimeout=void 0),this.playing=!0,this.paused=!1,this.richSquareObj&&this.richSquareObj.start(),this.playerType){case"sprite":!this.useMovieFile&&this.sheetNo>this.readySheetNoMax&&(this.resumeTimeout=setTimeout((function(){t.resume()}),200)),this.useMovieFile?(this.video.play(),this.sound&&(this.video.muted=!1)):(this.intervalId=setInterval((function(){t.next()}),1e3*this.interval),this.sound&&setTimeout((function(){t.audio.muted=!1,t.audio.play()}),1e3*this.interval)),this.handleEvent("resume"),this.handleEvent("play"),this.progressElem&&(this.progressInterval=setInterval((function(){t.progressValue+=t.interval/2,t.progressBar(t.progressValue)}),this.interval/2*1e3))}},l.prototype.replay=function(t){if(this.movieOverlay.style.background="transparent",this.loopButton.style.display="none",this.loopButton.style.display="none",this.hideLastPage(),this.loadImage.style.display="none",this.progressElem&&(this.progressElem.style.width="0"),this.playing=!0,this.playEnded=!1,this.playTime=0,this.useMovieFile?this.video.currentTime=0:(this.frameIndex=0,this.frameIndexTotal=0,this.sheetNo=1,this.audio&&(this.audio.currentTime=0)),this.handleEvent("repeat"),t){this.lookWindow.style.display="block",this.thumbnail.style.display="none";var e=this;setTimeout((function(){e.play(!0)}),200)}else this.lookWindow.style.display="none",this.loadImage.style.display="block",this.thumbnail.style.display="block",e=this,setTimeout((function(){e.play(!0)}),200)},l.prototype.finish=function(e){if(void 0===e&&(e=!0),void 0!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),void 0!==this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=void 0),this.progressElem&&(this.progressElem.style.width="100%"),this.playing=!1,this.playEnded=!0,this.finishedOnce=!0,this.sound&&(this.useMovieFile?this.video.muted=!0:(this.audio.muted=!0,this.audio.pause())),e&&(this.playComplete(),this.sendMessage({type:t.NAMESPACE+"-player-play-ended",adUnitId:this.conf.adUnitId,frameId:this.conf.frameId})),2==this.conf.endBy)this.autoReplayCount+=1,this.replay(!0);else{if(this.useMovieFile)this.video.currentTime=this.video.duration;else if(this.frameIndexTotal<this.conf.totalFrames-1){this.frameIndexTotal=this.conf.totalFrames-1;var i="translate(0, -"+this.frameIndexTotal*this.conf.height+"px)",n=this.lookWindow;n.style.transform=i,n.style.webkitTransform=i,n.style.MozTransform=i,n.style.msTransform=i,n.style.OTransform=i}this.showLastPage(),this.soundOnButton.style.display="none",this.soundOffButton.style.display="none",this.fullscreenButton.style.display="none",this.richSquareObj&&(this.richSquareObj.timeUpdate(this.conf.duration),this.richSquareObj.stop())}},l.prototype.videoPlay=function(){var t=this.video;setTimeout((function(){t.play()}),100)},l.prototype.showFullScreenVideo=function(){this.video&&(h.isFullScreen()||(p.ignoreScroll=!0,this.video.currentTime=0,this.video.requestFullscreen?this.video.requestFullscreen():this.video.msRequestFullscreen?this.video.msRequestFullscreen():this.video.mozRequestFullScreen?this.video.mozRequestFullScreen():this.video.webkitRequestFullscreen?this.video.webkitRequestFullscreen():this.video.webkitEnterFullScreen&&this.video.webkitEnterFullScreen()))},l.prototype.endFullScreenVideo=function(){this.finish()},l.prototype.fullScreenChanged=function(t){return void 0===t&&(t=h.isFullScreen()),this.fullscreenTarget?void(t?(this.handleEvent("enterFullscreen"),this.playing&&this.pause()):(this.hideFullScreenVideo(),this.handleEvent("endFullscreen"),this.fullscreenTarget=!1)):(t?(this.handleEvent("enterFullscreen"),this.playing&&this.pause()):(this.paused&&this.resume(),this.handleEvent("endFullscreen")),void(this.fullscreenTarget=!1))},l.prototype.hideFullScreenVideo=function(){document.exitFullScreen?document.exitFullScreen():document.webkitExitFullScreen?document.webkitExitFullScreen():this.video.cancelFullscreen?this.video.cancelFullscreen():this.video.msCancelFullscreen?this.video.msCancelFullscreen():this.video.mozCancelFullScreen?this.video.mozCancelFullScreen():this.video.webkitCancelFullscreen?this.video.webkitCancelFullscreen():this.video.webkitExitFullScreen&&this.video.webkitExitFullScreen(),this.playEnded||(this.video.pause(),this.frameIndexTotal=Math.floor(this.playTime*this.conf.fps),this.frameIndex=this.frameIndexTotal%this.conf.frames,this.sheetNo=Math.floor(this.frameIndexTotal/this.conf.frames),this.progressValue=this.playTime,this.progressBar(this.playTime),this.richSquareObj&&this.richSquareObj.timeUpdate(this.playTime),this.resume())},l.prototype.progressFullScreenVideo=function(){if(this.fullscreenTarget){this.playTime=this.video.currentTime;var t=this,e=this.playTime;setTimeout((function(){t.handleTimeEvent(e)}),0)}},l.prototype.handleTimeEvent=function(t){if(!this.playEnded){var e=this.conf.duration;if(this.richSquareObj&&this.richSquareObj.timeUpdate(t),11===this.conf.adType){var i=t/e*100,n=(e-5)/4;if(1<t&&!this.trackingSent.D1)return this.trackingSent.D1=!0,void this.sendVc("10");if(5<t&&!this.trackingSent.C1)return s=t+n,this.trackingSent.C1=!0,void this.sendVc("11");if(s<=t&&0<s){if(s=t+n,25<i&&!this.trackingSent.C25)return this.trackingSent.C25=!0,void this.sendVc("12");if(50<i&&!this.trackingSent.C50)return this.trackingSent.C50=!0,void this.sendVc("13");if(75<i&&!this.trackingSent.C75)return this.trackingSent.C75=!0,void this.sendVc("14")}}else{if(1<t&&!this.trackingSent[1])return this.trackingSent[1]=!0,void this.sendVc("0");if(25<t/e*100&&!this.trackingSent[25])return this.trackingSent[25]=!0,void this.sendVc("1");if(50<t/e*100&&!this.trackingSent[50])return this.trackingSent[50]=!0,void this.sendVc("2");if(75<t/e*100&&!this.trackingSent[75])return this.trackingSent[75]=!0,void this.sendVc("3")}}},l.prototype.playComplete=function(t){var e=this;11===this.conf.adType?setTimeout((function(){e.trackingSent.C100||(e.trackingSent.C100=!0,e.sendVc("15"))}),0):setTimeout((function(){e.trackingSent[100]||(e.trackingSent[100]=!0,e.sendVc("4"))}),0)},l.prototype.sendVc=function(t){var e=this.conf.vcUrl.replace(/\{progress\}/g,""+t);if(this.createBeaconImg(e),void 0!==this.thirdPartyTracking["vc"+t])for(var i=this.thirdPartyTracking["vc"+t],n=i.length,o=0;o<n;o++){var a=i[o];void 0!==a.typ&&1==a.typ?this.createTrackingFrame(a.ctt):this.createBeaconImg(a.ctt||a)}},l.prototype.sendClick=function(){this.createBeaconImg(this.conf.clickUrl)},l.prototype.createBeaconImg=function(t){if(!this.conf.test){var e=document.createElement("img");e.src=t,e.style.width=0,e.style.height=0,e.style.display="none",this.beacon.appendChild(e)}},l.prototype.createTrackingFrame=function(t){if(!this.conf.test){var e=document.createElement("iframe");e.setAttribute("scrolling","no"),e.setAttribute("marginwidth","0"),e.setAttribute("marginheight","0"),e.setAttribute("frameborder","no"),e.setAttribute("allowfullscreen","false"),e.setAttribute("style","width: 0; height: 0; margin: 0 auto; padding: 0; border: none; outline: none;"),this.beacon.appendChild(e);try{var i="";i+="<!DOCTYPE html><html>",i+="<head></head>",i+='<body style="margin:0; padding: 0;">',i+=t,i+="</body>",i+="</html>";var n=e.contentDocument?e.contentDocument:e.contentWindow.document;n.open(),n.write(i),n.close()}catch(t){return}}},l.prototype.startOverlay=function(){this.conf.tagManageParam.hasOverlayCloseButton?this.closeButton.style.display="block":this.closeButton.style.display="none",this.overlay=!0},l.prototype.endOverlay=function(){this.conf.tagManageParam.hasCloseButton?this.closeButton.style.display="block":this.closeButton.style.display="none",this.overlay=!1},l.prototype.getSize=function(){return{width:this.conf.width,height:this.conf.height}},l.prototype.sendMessage=function(t){window.postMessage(t,"*")},l.prototype.destroy=function(){void 0!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),void 0!==this.progressInterval&&(clearInterval(this.progressInterval),this.progressInterval=void 0),this.pause(),this.audio&&(this.audio.pause(),this.audio.src="",this.audio=null),this.video&&(this.video.pause(),this.video.src="",this.video=null)},l.prototype.setClickMacro=function(t){this.clickMacro=t},l.prototype.addEvent=function(t,e){void 0===this.adEvent[t]&&(this.adEvent[t]=[]),this.adEvent[t].push(e)},l.prototype.handleEvent=function(t){if(void 0!==this.adEvent[t])for(var e=this.adEvent[t],i=e.length,n=0;n<i;n++){var o=e[n];"function"==typeof o?o():this.createBeaconImg(o)}},l.prototype.addImpEventTracking=function(t){var e=t.length;void 0===this.thirdPartyTracking.imp&&(this.thirdPartyTracking.imp=[]);for(var i=0;i<e;i++)this.thirdPartyTracking.imp.push(t[i])},l.prototype.addVc1EventTracking=function(t){var e=t.length;void 0===this.thirdPartyTracking.vc1&&(this.thirdPartyTracking.vc1=[]);for(var i=0;i<e;i++)this.thirdPartyTracking.vc1.push(t[i])},l.prototype.addVc2EventTracking=function(t){var e=t.length;void 0===this.thirdPartyTracking.vc2&&(this.thirdPartyTracking.vc2=[]);for(var i=0;i<e;i++)this.thirdPartyTracking.vc2.push(t[i])},l.prototype.addVc3EventTracking=function(t){var e=t.length;void 0===this.thirdPartyTracking.vc3&&(this.thirdPartyTracking.vc3=[]);for(var i=0;i<e;i++)this.thirdPartyTracking.vc3.push(t[i])},l.prototype.addVc4EventTracking=function(t){var e=t.length;void 0===this.thirdPartyTracking.vc4&&(this.thirdPartyTracking.vc4=[]);for(var i=0;i<e;i++)this.thirdPartyTracking.vc4.push(t[i])},l.prototype.addCallback=function(t,e,i){var n=void 0!==this.callback[t]?this.callback[t]:null;this.callback[t]=function(){null!=n&&n.apply(i),e.apply(i)}},l.prototype.showInteractiveButton=function(){if(void 0===this.showInteractiveButtonTimeout&&!this.interactiveMode&&this.interactionButton&&this.hasInteractiveButton){var t=this.interactionButton;this.showInteractiveButtonTimeout=setTimeout((function(){t.style.display="block"}),SLIDE_DOWN_SHOW_INTERACTION_BTN_TIMEOUT)}},l.prototype.hideInteractiveButton=function(){void 0!==this.showInteractiveButtonTimeout&&(clearTimeout(this.showInteractiveButtonTimeout),this.showInteractiveButtonTimeout=void 0),this.interactionButton&&(this.interactionButton.style.display="none")},window.AdmatrixAdPlayer=l,c.getUid=function(t,e){return e?t+Math.random().toString(36).slice(8):t},c.prototype.initBuster=function(){var e={};e.topMargin=this.overlayTopMargin,this.staticOffset&&(e.offsetTop=this.defaultOffsetY),e.zIndex=this.overlayZindex;var i={};if(this.options.tagmp)for(var n=Object.keys(this.options.tagmp),o=n.length,a=0;a<o;a++)if(Array.isArray(this.options.tagmp[n[a]])){i[n[a]]=[];for(var s=this.options.tagmp[n[a]].length,r=0;r<s;r++)i[n[a]].push(this.options.tagmp[n[a]][r])}else i[n[a]]=this.options.tagmp[n[a]];var d={};void 0!==this.ad.cp&&(d=this.ad.cp),window.top.postMessage({type:t.NAMESPACE+"-over-frame-create",adUnitId:this.adUnitId,frameId:this.frameId,contentType:this.ad.acttt,overlay:this.options.overlay,overlayParam:e,tagmp:i,adUnitWidth:this.options.width,adUnitHeight:this.options.height,adCustomParam:d},"*")},c.prototype.empty=function(){var e=this.el;if(e){e.style.margin="0 auto",e.style.height="auto",h.rmEl(e,"click");var i=document.getElementById(t.NAMESPACE+"-m-"+this.adUnitId);if(i&&(i.style.height="0"),null!=this.admatrixAdMediation){try{this.admatrixAdMediation.mediationContainer&&(this.admatrixAdMediation.mediationContainer.style.width="0",this.admatrixAdMediation.mediationContainer.style.height="0"),this.admatrixAdMediation.destroy()}catch(e){}this.admatrixAdMediation=null}if(this.slideDownObj&&(this.slideDownObj.destroy(),this.slideDownObj=null),this.player&&(this.player.destroy(),this.player=null),this.containerId){var n=document.getElementById(this.containerId);n&&n.parentNode&&n.parentNode.removeChild(n)}}},c.prototype.destroy=function(){void 0!==this.viewWait&&(clearTimeout(this.viewWait),this.viewWait=void 0),void 0!==this.busterWait&&(clearTimeout(this.busterWait),this.busterWait=void 0),void 0!==this.playerWait&&(clearTimeout(this.playerWait),this.playerWait=void 0),void 0!==this.scrollOffsetInterval&&(clearInterval(this.scrollOffsetInterval),this.scrollOffsetInterval=void 0),void 0!==p.extPlayerArgs[this.adUnitId]&&delete p.extPlayerArgs[this.adUnitId],this.empty(),this.needRenderSend=!1,this.renderSent=!1,this.busterReady=!1,this.player=null,this.busterReady=!1,this.vast=!1,this.el=null,this.ad=null,this.adnwUnitId=null,this.defaultOffsetY=null,this.overlayTopMargin=0,this.staticOffset=!1,this.overlayZindex=4999,this.scrollPassThrough=!1,this.visibilityWhenScrollStart=null,this.visibility=null,this.visibilityWhenScrollEnd=null,this.adUnitPosition=null,this.options.hasBuster&&window.top.postMessage({type:t.NAMESPACE+"-over-frame-destroy",adUnitId:this.adUnitId,frameId:this.frameId},"*")},c.prototype.show=function(){if(this.el){this.empty();var e=this;if(!this.hasBuster||this.busterReady){var i=document.createElement("div");if(i.id=t.NAMESPACE+"-block-"+c.getUid(this.adUnitId,this.options.alt),i.className="admatrixAd-block",this.containerId=i.id,i.style="position: relative; top: 0px; left: 0px; margin: 0px; padding: 0px; display: inline-block; width: "+this.el.style.width+"; height: "+(this.el.style.height?this.el.style.height:auto)+";",this.el.appendChild(i),this.options.overlay)this.el.style.transform="translate3d(0, 0, 0)",void 0!==this.options.tagmp.overlayAlways&&this.options.tagmp.overlayAlways?this.changeFixedStyle():this.changeRelativeStyle();else if(!this.options.inFrame&&void 0!==this.options.tagmp.fitToLeft&&this.options.tagmp.fitToLeft){for(var o=this.el,a=0;o.offsetTop,a+=o.offsetLeft||0,o=o.offsetParent;);0<a&&(this.el.style.margin="0 0 0 -"+a+"px")}var s=p.inDapIF;if(7!=this.ad.acttt&&!0===s)try{var r,d=window,h=!1;r=window;do{for(var l=r,u=r.parent,f=u.document.getElementsByTagName("iframe"),m=f.length,g=0;g<m;g++)if(f[g].contentWindow===l){f[g].style.width=this.options.width+"px",f[g].style.height=void 0!==this.options.containerHeight?this.options.containerHeight+"px":this.options.height+"px",f[g].style.margin="auto",f[g].width=this.options.width,f[g].height=void 0!==this.options.containerHeight?this.options.containerHeight:this.options.height;break}if(u==d.top){h=!0;break}r=u}while(!h)}catch(e){}switch(this.ad.cttDt=this.ad.cttDt?this.ad.cttDt.replace(/\$\{width\}/g,this.options.width):this.ad.cttDt,void 0!==this.options.clickMacro&&null!=this.options.clickMacro&&""!=this.options.clickMacro&&(this.ad.clcUrl=this.options.clickMacro+encodeURIComponent(this.ad.clcUrl)),this.defaultOffsetY=null,this.ad.acttt){case 1:break;case n:this.createMovieElem(i);break;default:return void(this.onError&&this.onError("unknown content type."))}1==this.options.isDsp&&9!=this.ad.acttt&&12!=this.ad.acttt&&(this.shown=!0),this.ad&&void 0!==this.ad.tpe&&void 0!==this.ad.tpe.render&&null!=this.ad.tpe.render&&this.addEventTracking(this.ad.tpe.render.concat())}else this.busterWait=setTimeout((function(){e.show()}),200)}},c.prototype.changeFixedStyle=function(){if(this.player){this.player.startOverlay();var e=this.player.getSize(),i=document.getElementById(t.NAMESPACE+"-m-"+this.adUnitId);i&&(i.style.height=e.height+"px")}this.el.style.position="fixed",this.el.style.top=0<this.overlayTopMargin?this.overlayTopMargin+"px":this.overlayTopMargin,this.el.style.left=(window.innerWidth-this.options.width)/2+"px",this.el.style.zIndex=this.overlayZindex,this.currentStyle="fixed"},c.prototype.changeRelativeStyle=function(){this.player&&this.player.endOverlay();var e=document.getElementById(t.NAMESPACE+"-m-"+this.adUnitId);e&&(e.style.height="0"),this.el.style.position="relative",this.el.style.top="auto",this.el.style.left="auto",this.el.style.zIndex="auto",this.currentStyle="relative"},c.prototype.closeOverlay=function(){if(this.changeRelativeStyle(),void 0!==this.options.tagmp.overlayAlways&&this.options.tagmp.overlayAlways){this.destroy();var e=this;setTimeout((function(){e.onDestroySelf&&e.onDestroySelf()}),10)}else this.player&&this.player.finish(!1),this.options.hasBuster&&this.options.overlay&&window.top.postMessage({type:t.NAMESPACE+"-overlay-close",adUnitId:this.adUnitId,frameId:this.frameId},"*")},c.prototype.playEnded=function(){this.options.hasBuster&&this.options.overlay&&window.top.postMessage({type:t.NAMESPACE+"-overlay-disable",adUnitId:this.adUnitId,frameId:this.frameId},"*")},c.prototype.playStarted=function(){this.options.hasBuster&&this.options.overlay&&window.top.postMessage({type:t.NAMESPACE+"-overlay-enable",adUnitId:this.adUnitId,frameId:this.frameId},"*")},c.prototype.overlayEnable=function(){this.options.hasBuster&&this.options.overlay&&window.top.postMessage({type:t.NAMESPACE+"-overlay-enable",adUnitId:this.adUnitId,frameId:this.frameId},"*")},c.prototype.overlayStarted=function(){this.player&&this.options.overlay&&this.player.startOverlay()},c.prototype.overlayEnded=function(){this.player&&this.options.overlay&&this.player.endOverlay()},c.prototype.createMovieElem=function(e){var i=document.createElement("div");i.id=t.NAMESPACE+"Video-"+c.getUid(this.adUnitId,this.options.alt),i.className="admatrixVideo",e.appendChild(i);var n=new l(d.getResult());this.addPlayer(n)},c.prototype.getElement=function(){return this.ad&&void 0!==this.ad.extend&&void 0!==this.ad.extend.type?document.getElementById(t.NAMESPACE+"Video-"+this.adUnitId):this.el},c.prototype.waitForPlayer=function(){if(this.player)if(this.player.loading)e=this,this.playerWait=setTimeout((function(){e.waitForPlayer()}),100);else if(1!=this.player.conf.startBy)if(this.options.inFrame){if(this.options.safeFrame)return void(50<p.sfExt.inViewPercentage()&&c.prototype.onVisible.apply(this,arguments));if(this.options.hasBuster)return void window.top.postMessage({type:t.NAMESPACE+"-over-frame-playerReady",adUnitId:this.adUnitId,frameId:this.frameId},"*")}else c.prototype.visibilityChanged.apply(this,arguments);else this.onVisible();else{var e=this;this.playerWait=setTimeout((function(){e.waitForPlayer()}),100)}},c.prototype.onDocumentComplete=function(){this.vast&&(this.vastPlayerReady=!0)},c.prototype.addPlayer=function(t){if(this.ad){if(t.trnId=this.trnId,this.ad.tpe&&(this.ad.tpe.imp&&t.addImpEventTracking(this.ad.tpe.imp.concat()),this.ad.tpe.vc1&&t.addVc1EventTracking(this.ad.tpe.vc1.concat()),this.ad.tpe.vc2&&t.addVc2EventTracking(this.ad.tpe.vc2.concat()),this.ad.tpe.vc3&&t.addVc3EventTracking(this.ad.tpe.vc3.concat()),this.ad.tpe.vc4&&t.addVc4EventTracking(this.ad.tpe.vc4.concat())),void 0!==this.options.clickMacro&&null!=this.options.clickMacro&&""!=this.options.clickMacro&&t.setClickMacro(this.options.clickMacro),void 0!==this.ad.extend&&void 0!==this.ad.extend.data&&void 0!==this.ad.extend.data.event){var e=this.ad.extend.data.event;l.trackableEvents.forEach((function(i){void 0!==e[i]&&t.addEvent(i,e[i])}))}this.player=t,void 0!==this.options.tagmp.overlayAlways&&this.options.tagmp.overlayAlways&&this.changeFixedStyle()}},c.prototype.scrollStart=function(){this.ad&&(this.visibilityWhenScrollStart=h.getVisibility(this.getElement(),this.options.tagmp||{}),this.options.overlay||this.ad.acttt!=n&&this.ad.acttt!=o&&this.ad.acttt!=a||!this.player||("BELOW"==this.visibilityWhenScrollStart&&(this.scrollPassThrough=!0),this.player.scrollStart(this.visibilityWhenScrollStart),this.slideDownObj&&this.slideDownObj.scrollStart(this.visibilityWhenScrollStart)),this.visibilityWhenScrollEnd=null)},c.prototype.scrollStartFromFrame=function(t){this.ad&&(this.visibilityWhenScrollStart=t,this.options.overlay||this.ad.acttt!=n&&this.ad.acttt!=o&&this.ad.acttt!=a||!this.player||("BELOW"==this.visibilityWhenScrollStart&&(this.scrollPassThrough=!0),this.player.scrollStart(this.visibilityWhenScrollStart),this.slideDownObj&&this.slideDownObj.scrollStart(this.visibilityWhenScrollStart)),this.visibilityWhenScrollEnd=null)},c.prototype.scrollEnd=function(){if(this.ad){if(this.visibilityWhenScrollEnd=h.getVisibility(this.getElement(),this.options.tagmp||{}),!this.options.overlay&&(this.ad.acttt==n||this.ad.acttt==o||this.ad.acttt==a)&&this.player){switch(this.visibilityWhenScrollStart){case"ABOVE":"BELOW"==this.visibilityWhenScrollEnd?(this.scrollPassThrough=!0,this.slideDownObj&&!this.slideDownObj.shown&&(this.player.hasInteractiveButton=!0)):this.visibilityWhenScrollEnd;break;case"BELOW":"VISIBLE"==this.visibilityWhenScrollEnd&&this.slideDownObj&&!this.slideDownObj.shown&&(this.player.hasInteractiveButton=!0)}this.player.scrollEnd(this.visibilityWhenScrollEnd,this.scrollPassThrough),this.slideDownObj&&this.slideDownObj.scrollEnd(this.visibilityWhenScrollEnd,this.scrollPassThrough)}this.visibilityWhenScrollStart=null}},c.prototype.scrollEndFromFrame=function(t){if(this.ad){if(this.visibilityWhenScrollEnd=t,!this.options.overlay&&(this.ad.acttt==n||this.ad.acttt==o||this.ad.acttt==a)&&this.player){switch(this.visibilityWhenScrollStart){case"ABOVE":"BELOW"==this.visibilityWhenScrollEnd?(this.scrollPassThrough=!0,this.slideDownObj&&!this.slideDownObj.shown&&(this.player.hasInteractiveButton=!0)):this.visibilityWhenScrollEnd;break;case"BELOW":"VISIBLE"==this.visibilityWhenScrollEnd&&this.slideDownObj&&!this.slideDownObj.shown&&(this.player.hasInteractiveButton=!0)}this.player.scrollEnd(this.visibilityWhenScrollEnd,this.scrollPassThrough),this.slideDownObj&&this.slideDownObj.scrollEnd(this.visibilityWhenScrollEnd,this.scrollPassThrough)}this.visibilityWhenScrollStart=null}},c.prototype.visibilityChanged=function(){if(this.ad){var e=this,i=!1,s=document,r=this.getElement();if(r){if(void 0!==document.visibilityState&&"visible"!=document.visibilityState)return this.offVisible(),void(this.visibility="ABOVE");if(p.amp){if(void 0!==p.currentIntersection){var d=p.currentIntersection;void 0!==d.intersectionRect&&((i=d.intersectionRect.height>this.options.height/2&&d.intersectionRect.width>this.options.width/2)?this.onVisible():this.offVisible())}}else if(this.ad)if((this.ad.acttt!=n||this.vast)&&this.ad.acttt!=o&&this.ad.acttt!=a||this.player){var l=0;if(void 0!==this.options.tagmp&&void 0!==this.options.tagmp.scrollParent)try{var c=s.getElementById(this.options.tagmp.scrollParent);c&&(l=c.scrollTop)}catch(e){}else l=window.pageYOffset;i=this.options.overlay&&null!=this.defaultOffsetY&&(this.ad.acttt==n||this.ad.acttt==o||this.ad.acttt==a)&&this.player?this.options.tagmp.overlayAlways?"VISIBLE":this.player.playEnded?l<=this.defaultOffsetY?("relative"!=this.currentStyle&&this.changeRelativeStyle(),h.getVisibility(r,this.options.tagmp||{})):"relative"!=this.currentStyle?"VISIBLE":h.getVisibility(r,this.options.tagmp||{}):l>this.defaultOffsetY?("fixed"!=this.currentStyle&&this.changeFixedStyle(),"VISIBLE"):("relative"!=this.currentStyle&&this.changeRelativeStyle(),h.getVisibility(r,this.options.tagmp||{})):(this.options.overlay&&null==this.defaultOffsetY&&!this.staticOffset&&(this.defaultOffsetY=s.getElementById(t.NAMESPACE+"-m-"+this.adUnitId).offsetTop,this.scrollOffsetInterval=setInterval((function(){"relative"==e.currentStyle&&(e.defaultOffsetY=s.getElementById(t.NAMESPACE+"-m-"+e.adUnitId).offsetTop)}),1e3)),h.getVisibility(r,this.options.tagmp||{})),"VISIBLE"==(i=h.getVisibilityByIntersectionObserver(e))?this.onVisible():this.offVisible(),this.visibility=i,void 0!==this.options.tagmp&&void 0!==this.options.tagmp.scrollEventDisabled&&this.options.tagmp.scrollEventDisabled&&(this.visibilityCheckTimeout=setTimeout((function(){e.visibilityChanged()}),200))}else e=this,setTimeout((function(){e.visibilityChanged()}),100)}}},c.prototype.onVisible=function(){if(this.ad)if(this.ad.acttt==n&&!this.vast||this.ad.acttt==o||this.ad.acttt==a){if(!this.player)return;this.player.visible()}else this.ad&&void 0!==this.ad.tpe&&void 0!==this.ad.tpe.imp&&null!=this.ad.tpe.imp&&this.addEventTracking(this.ad.tpe.imp.concat())},c.prototype.addEventTracking=function(t){if(!this.options.testMode)for(var e=t.length,i=0;i<e;i++){var n=t[i];if(void 0!==n.typ&&1==n.typ){var o=document.createElement("iframe");o.setAttribute("scrolling","no"),o.setAttribute("marginwidth","0"),o.setAttribute("marginheight","0"),o.setAttribute("frameborder","no"),o.setAttribute("allowfullscreen","false"),o.setAttribute("style","width: 0; height: 0; margin: 0 auto; padding: 0; border: none; outline: none;"),this.el.appendChild(o);try{var a="";a+="<!DOCTYPE html><html>",a+="<head></head>",a+='<body style="margin:0; padding: 0;">',a+=n.ctt,a+="</body>",a+="</html>";var s=o.contentDocument?o.contentDocument:o.contentWindow.document;s.open(),s.write(a),s.close()}catch(t){}}else try{var r=new Image(1,1);r.src=n.ctt||n,r.style.display="none",this.el.appendChild(r)}catch(t){}}},c.prototype.offVisible=function(){if(this.ad)if(this.ad.acttt==n&&!this.vast||this.ad.acttt==o||this.ad.acttt==a){if(!this.player)return;this.player.hidden()}else this.vast&&this.vastPlayerReady&&this.vastElem.postMessage({type:t.NAMESPACE+"-vast-hidden",adUnitId:this.adUnitId},"*")},c.prototype.changeVisibility=function(t){if(this.ad.acttt==o&&this.player&&this.slideDownObj){switch(t){case"VISIBLE":null==this.visibilityWhenScrollStart||this.slideDownObj.shown||this.slideDownObj.shownPartial||this.scrollPassThrough||this.player.detailButtonShown?this.scrollPassThrough&&"BELOW"==this.visibility&&(this.slideDownObj.shown||(this.player.hasInteractiveButton=!0)):this.slideDownObj.prepareOpenPartial();break;case"ABOVE":this.slideDownObj.cancelOpenPartial(),this.player.hideDetailButton();break;case"BELOW":this.slideDownObj.cancelOpenPartial(),this.player.hideDetailButton(),this.scrollPassThrough=!0,this.slideDownObj.shown||(this.player.hasInteractiveButton=!0);break;default:this.player.cancelDetailButtonTimeout()}this.slideDownObj.visibilityChanged()}this.visibility=t},c.prototype.fullscreenchanged=function(e){if(this.ad)if(this.ad.acttt==n&&!this.vast||this.ad.acttt==o||this.ad.acttt==a){if(!this.player)return;this.player.fullScreenChanged(e)}else this.vast&&this.vastElem.postMessage({type:t.NAMESPACE+"-vast-fullscreenchanged",isFullScreen:e},"*")};var p=window.AdmatrixAds||function(t){t=t||{},this.reqUrl="",t.testMode=t.testMode||!1,this.conf=t,void 0===this.conf.fTag&&(this.conf.fTag=""),void 0===this.conf.ovl&&(this.conf.ovl=0),void 0===this.conf.expandable&&(this.conf.expandable=!0),this.adIndex=0,this.requireAdCnt=1,this.currentAds=null,this.isContainMediation=!1,this.dmpSyncSent=!1,this.cookieSynced=!1};p.AdObj=c,p.prototype.init=function(){var i=p.inDapIF?window.top:window,n=document;if(this.targetElem=n.getElementById(this.conf.adUnitId),this.targetElem){this.targetElem.className="admatrixAdTargetElem";try{var o=n.createElement("div");o.id=t.NAMESPACE+"-m-"+this.conf.adUnitId,o.setAttribute("style","margin:0;padding:0;border:none;width:0;height:0;"),this.targetElem.parentNode.insertBefore(o,this.targetElem)}catch(i){}if(this.conf.type){var a=this.conf.type;if(void 0!==e[a]){if(void 0===e[a].full&&(e[a].full=!1),void 0===e[a].expand&&(e[a].expand=!1),void 0===e[a].reload&&(e[a].reload=!1),void 0===this.conf.width&&e[a].full){var s=h.getWindowHeight(i);i.innerWidth>s?this.conf.width=s||e[a].w:this.conf.width=i.innerWidth||e[a].w}else this.conf.width=this.conf.width||e[a].w;if(void 0===this.conf.height||(this.conf.containerHeight=this.conf.height),e[a].expand&&this.conf.expandable?this.conf.height=e[a].h*this.conf.width/e[a].w:this.conf.height=this.conf.height||e[a].h,e[a].expand||!(this.conf.width<e[a].w||this.conf.height<e[a].h))return 90==a&&160<this.conf.width&&(this.requireAdCnt=2),this.currentAds=[],!0;this.conf.onError({detail:"["+t.NAMESPACE+"] container size is too small."},this.conf.adUnitId)}else void 0!==this.conf.onError&&this.conf.onError({detail:"["+t.NAMESPACE+"] unknown type."},this.conf.adUnitId)}else void 0!==this.conf.onError&&this.conf.onError({detail:"["+t.NAMESPACE+"] unknown type."},this.conf.adUnitId)}else void 0!==this.conf.onError&&this.conf.onError({detail:"["+t.NAMESPACE+"] target element not exists."})},p.prototype.showAd=function(){if(!this.aborted){void 0!==this.reloadTO&&(clearTimeout(this.reloadTO),this.reloadTO=void 0),this.adIndex=0,this.conf.fTag="",this.isContainMediation=!1;var e={untId:this.conf.adUnitId,os:3,tst:this.conf.testMode?1:0,adTp:this.conf.type,amp:p.amp?1:0,ovfrm:p.inFrame?1:0,rf:p.referrer?encodeURIComponent(p.referrer):"",dos:p.os,dosv:p.osVersion,vsf:h.isVastSupported()?1:0};p.footprintUid&&""!=p.footprintUid&&(e.fpuid=p.footprintUid);var i=this;if(!i.aborted){var n=r();if(i.removeCurrent(),i.conf.ftw=0,void(i.conf.fth=0)!==n.fTag&&(i.conf.fTag=n.fTag,i.conf.frf="1"==n.frf,i.conf.ftw=void 0!==n.ftw?n.ftw:0,i.conf.fth=void 0!==n.fth?n.fth:0),void 0!==n.tagmp)try{i.conf.tagmp=JSON.parse(n.tagmp)}catch(e){i.conf.tagmp={}}else i.conf.tagmp={};void 0!==i.conf.tagmp.keepSizeWhenPassBack&&(i.conf.keepSizeWhenPassBack=i.conf.tagmp.keepSizeWhenPassBack),void 0!==i.conf.tagmp.zeroSizeWhenPassBack?i.conf.zeroSizeWhenPassBack=i.conf.tagmp.zeroSizeWhenPassBack:""!=i.conf.fTag||i.conf.keepSizeWhenPassBack||(i.conf.zeroSizeWhenPassBack=!0),void 0!==i.conf.tagmp.overlayParam&&(void 0===i.conf.overlayParam&&(i.conf.overlayParam={}),Object.keys(i.conf.tagmp.overlayParam).forEach((function(t){i.conf.overlayParam[t]=i.conf.tagmp.overlayParam[t]})),delete i.conf.tagmp.overlayParam,p.setOverlayParam(i.conf.adUnitId,i.conf.frameId,i.conf.overlayParam)),i.conf.ovl=void 0!==n.ovl?parseInt(n.ovl):0,i.conf.isDsp=void 0!==n.isDsp?n.isDsp:0,void 0!==n.ads?n.ads.length<=0?i.callError("["+t.NAMESPACE+"] no ads.",!1,!0):(i.ads=n.ads,i.createAd({})):i.callError("["+t.NAMESPACE+"] response not containds ads.",!1)}}},p.prototype.removeCurrent=function(){if(void 0!==this.reloadTO&&(clearTimeout(this.reloadTO),this.reloadTO=void 0),this.currentAds&&0<this.currentAds.length){for(var t=this.currentAds.length,e=0;e<t;e++)this.currentAds[e].destroy();this.currentAds=[]}},p.prototype.callError=function(e,i,n){if(this.abort(),p.amp)this.emptyForAmp();else if(""!=this.conf.fTag){this.conf.width,0<this.conf.ftw&&this.conf.ftw,0<this.conf.fth&&this.conf.fth;var o=p.inDapIF,a=!1;if(!0===o)if(void 0!==this.conf.tagmp.fitWithFiller&&this.conf.tagmp.fitWithFiller)a=!0;else if(!this.conf.keepSizeWhenPassBack)try{p.parentFrame&&(0<this.conf.ftw?(p.parentFrame.width=this.conf.ftw,p.parentFrame.style.width=this.conf.ftw+"px"):p.defaultParentWidth&&(p.parentFrame.width=p.defaultParentWidth,p.parentFrame.style.width=p.defaultParentWidth+"px",p.defaultParentWidth),0<this.conf.fth?(p.parentFrame.height=this.conf.fth,p.parentFrame.style.height=this.conf.fth+"px"):p.defaultParentHeight&&(p.parentFrame.height=p.defaultParentHeight,p.parentFrame.style.height=p.defaultParentHeight+"px",p.defaultParentHeight))}catch(e){}if(!p.inDapIF&&this.conf.safeFrame&&void 0!==p.sfExt&&void 0!==p.sfExt.expand)try{void 0!==p.defaultGeom&&p.safeFrameExpand({t:p.defaultGeom.t,l:p.defaultGeom.l,r:p.defaultGeom.r,b:p.defaultGeom.b,push:!0})}catch(e){}var s=document.createElement("iframe");s.id=t.NAMESPACE+"-filler-"+this.conf.adUnitId,s.src="javascript:\"<html><body style='background:transparent'></body></html>\"",s.setAttribute("scrolling","no"),s.setAttribute("marginwidth","0"),s.setAttribute("marginheight","0"),s.setAttribute("frameborder","no"),s.setAttribute("allowfullscreen","false"),0<this.conf.ftw&&0<this.conf.fth?s.setAttribute("style","margin: 0 auto; padding: 0; border: none; outline: none; position: relative; display: block; width: "+this.conf.ftw+"px; height: "+this.conf.fth+"px;"):!0===o&&!this.conf.keepSizeWhenPassBack&&p.parentFrame?s.setAttribute("style","margin: 0 auto; padding: 0; border: none; outline: none; position: relative; display: block; width: "+p.defaultParentWidth+"px; height: "+p.defaultParentHeight+"px;"):s.setAttribute("style","margin: 0 auto; padding: 0; border: none; outline: none; position: relative; display: block;"),this.conf.frf?(this.targetElem.setAttribute("style","width: 0; height: 0; margin: 0 auto; padding: 0; border: none; overflow: hidden;"),this.targetElem.parentNode.insertBefore(s,this.targetElem)):(this.targetElem.setAttribute("style","width: 100%; height: auto; margin: 0 auto; padding: 0; border: none;"),this.targetElem.appendChild(s)),a&&(this.targetElem,s.onload=function(){setTimeout((function(){try{var t=s.contentDocument?s.contentDocument:s.contentWindow.document,e=t.body.scrollWidth,i=t.body.scrollHeight;s.style.width=e+"px",s.style.height=i+"px",p.parentFrame.style.margin="0 auto",p.parentFrame.width=e,p.parentFrame.style.width=e+"px",p.parentFrame.height=i,p.parentFrame.style.height=i+"px"}catch(t){}}),100)});try{var r=s.contentDocument?s.contentDocument:s.contentWindow.document;r.open(),r.write('<!DOCTYPE html><html><head><script type="text/javascript">var inDapIF = true;<\/script></head><body style="margin:0;padding:0;">'+this.conf.fTag+"</body></html>"),r.close()}catch(e){}}else this.tagEmptyWithNoFiller(),void 0!==this.conf.onError&&(e=e||"",this.conf.onError({detail:e},this.conf.adUnitId))},p.prototype.emptyForAmp=function(){if(void 0!==window.context&&void 0!==window.context.renderStart)try{window.context.requestResize(0,0)}catch(t){console.log(t)}else console.log("["+t.NAMESPACE+" amp] requestResize undefined");if(void 0!==window.context&&void 0!==window.context.noContentAvailable)try{window.context.noContentAvailable()}catch(t){console.log(t)}else console.log("["+t.NAMESPACE+" amp] noContentAvailable undefined")},p.prototype.tagEmptyWithNoFiller=function(){var e=p.inDapIF;if(!0===e&&!this.conf.keepSizeWhenPassBack)try{p.parentFrame&&(p.defaultParentWidth&&(p.parentFrame.width=p.defaultParentWidth,p.parentFrame.style.width=p.defaultParentWidth+"px"),p.defaultParentHeight&&(p.parentFrame.height=p.defaultParentHeight,p.parentFrame.style.height=p.defaultParentHeight+"px"))}catch(e){}if(this.conf.zeroSizeWhenPassBack)if(!0===e)try{p.parentFrame&&(p.parentFrame.width="0",p.parentFrame.style.width="0",p.parentFrame.height="0",p.parentFrame.style.height="0")}catch(e){}else p.inFrame&&!this.conf.safeFrame&&(void 0!==this.conf.calledInFrameOption&&this.conf.calledInFrameOption?window.parent.postMessage({type:t.NAMESPACE+"-over-frame-raplacingFrame-noad",frameId:t.NAMESPACE+"-replacing-frame-"+this.conf.adUnitId,adUnitId:this.conf.adUnitId},"*"):window.top.postMessage({type:t.NAMESPACE+"-over-frame-noad",adUnitId:this.conf.adUnitId,frameId:this.conf.frameId},"*"));if(!p.inDapIF&&this.conf.safeFrame&&void 0!==p.sfExt&&void 0!==p.sfExt.expand)try{void 0!==p.defaultGeom&&p.safeFrameExpand({t:p.defaultGeom.t,l:p.defaultGeom.l,r:p.defaultGeom.r,b:p.defaultGeom.b,push:!0})}catch(e){}},p.prototype.createAd=function(){var t=this,i=this.targetElem;if(i){void 0!==this.reloadTO&&(clearTimeout(this.reloadTO),this.reloadTO=void 0);for(var n={},o=0;o<this.requireAdCnt&&(this.adIndex=this.adIndex+o,!(this.adIndex>=this.ads.length));o++){var a=this.ads[this.adIndex];if(a.tmp||(a.tmp={}),void 0!==a.cp&&""!=a.cp)try{var s=JSON.parse(a.cp);a.cp=s}catch(i){}0==o&&(n=this.adjustAdOptions(i,a)),0<o&&(n.alt=!0);var r=new p.AdObj(i,a,n,(function(e){console.log(e),0<o?t.showNextAd(!1):t.showNextAd()}),(function(){t.abort()}));this.currentAds.push(r),r.show(),0==o&&e[this.conf.type].reload&&void 0!==this.ads[this.adIndex].rldTm&&0<this.ads[this.adIndex].rldTm&&(this.reloadTO=setTimeout(h.proxy(this.showAd,this),1e3*this.ads[this.adIndex].rldTm))}}},p.prototype.adjustAdOptions=function(e,i){var n,o=this;if(void 0!==i.aRatio){var a=i.aRatio.split(":");n=parsent(a[1])/parseInt(a[0])}else n=this.conf.height/this.conf.width;if(p.inFrame&&void 0!==this.conf.tagmp.forceFrameWindowWidth&&this.conf.tagmp.forceFrameWindowWidth)this.conf.width=p.parentWindowWidth>p.parentWindowHeight?p.parentWindowHeight:p.parentWindowWidth,this.conf.height=this.conf.width*n;else if(!p.inFrame&&void 0!==this.conf.tagmp.forceFrameWindowWidth&&this.conf.tagmp.forceFrameWindowWidth){var s=h.getWindowHeight();this.conf.width=window.innerWidth>s?s:window.innerWidth,this.conf.height=this.conf.width*n}else if(void 0!==this.conf.tagmp.forcedWidth)if(0<(""+this.conf.tagmp.forcedWidth).indexOf("%"))try{var r=parseInt(this.conf.tagmp.forcedWidth.replace("%",""));if(100<r&&(r=100),p.inFrame){var d=p.parentWidth;this.conf.width=d*r/100,(this.conf.width>p.parentWindowWidth||this.conf.width>p.parentWindowHeight)&&(this.conf.width=p.parentWindowWidth>p.parentWindowHeight?p.parentWindowHeight:p.parentWindowWidth)}else{d=e.parentNode.clientWidth;var l=window.getComputedStyle(e.parentNode),c=l.getPropertyValue("padding-right");""!=c&&(d-=parseInt(c.replace("px","")));var u=l.getPropertyValue("padding-left");""!=u&&(d-=parseInt(u.replace("px",""))),this.conf.width=d*r/100;var f=h.getWindowHeight();(this.conf.width>window.innerWidth||this.conf.width>f)&&(this.conf.width=window.innerWidth>f?f:window.innerWidth)}this.conf.height=this.conf.width*n}catch(e){console.log("["+t.NAMESPACE+"] width parameter will be ignored because it is not valid int.")}else this.conf.width=this.conf.tagmp.forcedWidth;if(void 0!==this.conf.tagmp.forcedHeight&&(this.conf.height=this.conf.tagmp.forcedHeight),p.inFrame)if(p.inDapIF&&void 0!==this.conf.updateParentFrameSize&&this.conf.updateParentFrameSize)setTimeout((function(){window.top.postMessage({type:t.NAMESPACE+"-over-frame-update-size",width:o.conf.width,height:o.conf.height},"*")}),0);else if(!p.inDapIF&&void 0!==this.conf.tagmp.forcedWidth){this.conf.updateParentFrameSize=!0;var m=p.safeFrameWindowGeom();this.options.tagmp.fitToLeft?p.safeFrameExpand({l:0,r:m.w,b:m.t+conf.height,push:!0}):p.safeFrameExpand({r:m.l+conf.width,b:m.t+conf.height,push:!0})}var g=null;p.inFrame||(g=this.getUnitPosition());var v={width:this.conf.width,height:this.conf.height,adUnitId:this.conf.adUnitId,inFrame:p.inFrame,testMode:this.conf.testMode,clickMacro:void 0!==this.conf.clickMacro?this.conf.clickMacro:"",expandable:void 0===this.conf.expandable||this.conf.expandable,overlay:this.conf.ovl,keepSizeWhenPassBack:void 0!==this.conf.keepSizeWhenPassBack&&this.conf.keepSizeWhenPassBack,zeroSizeWhenPassBack:void 0!==this.conf.zeroSizeWhenPassBack&&this.conf.zeroSizeWhenPassBack,isDsp:this.conf.isDsp,tagmp:this.conf.tagmp,frameId:this.conf.frameId,position:g};return 90==this.conf.type&&(v.width=this.conf.width/2,v.float=!0),void 0!==this.conf.containerHeight&&(v.containerHeight=this.conf.containerHeight),v.safeFrame=this.conf.safeFrame,p.inFrame&&!this.conf.safeFrame&&(v.hasBuster=!0),v},p.prototype.showNextAd=function(e){void 0===e&&(e=!0),e&&this.removeCurrent(),this.ads?this.ads.length<=0||this.adIndex+1==this.ads.length?this.callError("["+t.NAMESPACE+"] no ads",!1,!0):(this.adIndex+=1,this.createAd()):this.callError("["+t.NAMESPACE+"] no ads",!1)},p.prototype.embedSync=function(e,i){if(this.syncFrames&&0<this.syncFrames.length){for(var n=this.syncFrames.length,o=0;o<n;o++){var a=this.syncFrames[o];setTimeout((function(){var t=document.getElementById(a);t&&i.removeChild(t)}),100)}this.syncFrames=null}if(e&&0<e.length){var s=[],r=(n=e.length,i);for(o=0;o<n;o++)try{var d=document.createElement("iframe");d.id=t.NAMESPACE+"Sync-"+(new Date).getTime(),d.src=e[o],d.setAttribute("scrolling","no"),d.setAttribute("marginwidth","0"),d.setAttribute("marginheight","0"),d.setAttribute("frameborder","no"),d.setAttribute("allowfullscreen","false"),d.setAttribute("style","width: 0; height: 0; margin: 0 auto; padding: 0; border: none; outline: none; margin-left: -9999px; position:absolute;"),r.appendChild(d),s.push(d.id)}catch(e){}this.syncFrames=s}},p.prototype.createDmpSync=function(t,e,i){if(""==t&&(t=[]),0!=t.length&&(void 0===i&&(i=0),i<t.length)){try{var n=this,o=t[i];setTimeout((function(){if(void 0!==o.synUrl&&void 0!==o.kbUrl){p.kbUrl=o.kbUrl;var t=document.createElement("script");t.async="true",t.src=o.synUrl+"&callback=AdmatrixAds.sendDmpRes",e.parentNode.insertBefore(t,e)}}),100)}catch(t){}n.createDmpSync(t,e,i+1)}},p.prototype.abort=function(){this.removeCurrent(),this.targetElem&&(this.targetElem.setAttribute("style","width: 0; height: 0; margin:0 auto; padding: 0; overflow: hidden;"),this.targetElem.className="");var e=document.getElementById(t.NAMESPACE+"-m-"+this.conf.adUnitId);e&&(e.style.height="0"),this.aborted=!0},p.prototype.visibilityChanged=function(){if((void 0===this.conf.tagmp||void 0===this.conf.tagmp.scrollEventDisabled||!this.conf.tagmp.scrollEventDisabled)&&this.currentAds&&0<this.currentAds.length)for(var t=this.currentAds.length,e=0;e<t;e++)this.currentAds[e].visibilityChanged()},p.prototype.scrollStart=function(){if(this.currentAds&&0<this.currentAds.length)for(var t=this.currentAds.length,e=0;e<t;e++)this.currentAds[e].scrollStart()},p.prototype.scrollEnd=function(){if(this.currentAds&&0<this.currentAds.length)for(var t=this.currentAds.length,e=0;e<t;e++)this.currentAds[e].scrollEnd()},p.prototype.scrollStartFromFrame=function(t){if(this.currentAds&&0<this.currentAds.length)for(var e=this.currentAds.length,i=0;i<e;i++)this.currentAds[i].scrollStartFromFrame(t)},p.prototype.scrollEndFromFrame=function(t){if(this.currentAds&&0<this.currentAds.length)for(var e=this.currentAds.length,i=0;i<e;i++)this.currentAds[i].scrollEndFromFrame(t)},p.prototype.updateViewable=function(t,e){"geom-update"==t&&(50<p.sfExt.inViewPercentage()?this.onVisible("VISIBLE"):this.offVisible("ABOVE"))},p.prototype.onVisible=function(t){if(this.currentAds&&0<this.currentAds.length)for(var e=this.currentAds.length,i=0;i<e;i++)this.currentAds[i].changeVisibility(t),this.currentAds[i].onVisible()},p.prototype.calcIntersection=function(){var t=p.currentIntersection||{};if(void 0!==t.intersectionRect&&this.currentAds&&0<this.currentAds.length)for(var e=t.intersectionRect.height>this.conf.height/2&&t.intersectionRect.width>this.conf.width/2,i=this.currentAds.length,n=0;n<i;n++)e?(this.currentAds[n].changeVisibility("VISIBLE"),this.currentAds[n].onVisible()):(this.currentAds[n].changeVisibility("ABOVE"),this.currentAds[n].offVisible())},p.prototype.offVisible=function(t){if(this.currentAds&&0<this.currentAds.length)for(var e=this.currentAds.length,i=0;i<e;i++)this.currentAds[i].changeVisibility(t),this.currentAds[i].offVisible()},p.prototype.addPlayer=function(t){if(this.currentAds&&0<this.currentAds.length){if(!t)return void this.currentAds[0].abort();this.currentAds[0].addPlayer(t)}},p.prototype.closeOverlay=function(){this.currentAds&&0<this.currentAds.length&&this.currentAds[0].closeOverlay()},p.prototype.playEnded=function(){this.currentAds&&0<this.currentAds.length&&this.currentAds[0].playEnded()},p.prototype.playStarted=function(){this.currentAds&&0<this.currentAds.length&&this.currentAds[0].playStarted()},p.prototype.overlayStarted=function(){this.currentAds&&0<this.currentAds.length&&this.currentAds[0].overlayStarted()},p.prototype.overlayEnded=function(){this.currentAds&&0<this.currentAds.length&&this.currentAds[0].overlayEnded()},p.prototype.onDocumentComplete=function(){this.currentAds&&0<this.currentAds.length&&this.currentAds[0].onDocumentComplete()},p.prototype.setAdUnitPosition=function(t){if(this.currentAds&&0<this.currentAds.length){var e=this.currentAds[0];t.eh=this.conf.containerHeight||this.conf.height,t.ew=this.conf.width,e.adUnitPosition=t,e.needRenderSend&&e.sendRender()}},p.prototype.getUnitPosition=function(){var t=document,e=t.getElementById(this.conf.adUnitId);if(e){var i=t.getElementsByTagName("HTML")[0].style.getPropertyValue("zoom"),n=1;i&&(/^[\d\.]+%$/.test(i)?n=parseFloat(i.replace("%",""))/100:/^[\d\.]+$/.test(i)&&(n=parseFloat(i)));for(var o=h.getWindowHeight(),a=window.innerWidth,s=(e.offsetHeight,e.offsetWidth,0),r=0,d=e;s+=d.offsetTop||0,r+=d.offsetLeft||0,d=d.offsetParent;);s*=n,r*=n;var l=t.body.scrollHeight,c=t.body.scrollWidth;return{wh:o,ww:a,eh:this.conf.containerHeight||this.conf.height,ew:this.conf.width,ot:s,ol:r,ph:l,pw:c,untId:this.conf.adUnitId,fm:0,sf:0}}return null},p.prototype.fullscreenchanged=function(t){this.currentAds&&0<this.currentAds.length&&this.currentAds[0].fullscreenchanged(t)},p.prototype.orientationChanged=function(){this.abort(),p.amp?this.emptyForAmp():this.tagEmptyWithNoFiller()},p.receiveMessage=function(e){if(e.data&&e.data.type)switch(e.data.type){case t.NAMESPACE+"-over-frame-raplacingFrame-noad":if(e.data.frameId){var i=e.data.frameId,n=document.getElementById(i);n&&(n.style.width="0",n.style.height="0");var o=e.data.adUnitId,a=document.getElementById(o);a&&(a.setAttribute("style","width: 0; height: 0; margin:0; padding: 0; overflow: hidden;"),a.className="")}break;case t.NAMESPACE+"-over-frame-fixed":p.adUnit&&e.data.adUnitId&&(o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].overlayStarted());break;case t.NAMESPACE+"-over-frame-relative":p.adUnit&&e.data.adUnitId&&(o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].overlayEnded());break;case t.NAMESPACE+"-player-play-ended":p.adUnit&&e.data.adUnitId&&(o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].playEnded());break;case t.NAMESPACE+"-player-play-started":p.adUnit&&e.data.adUnitId&&(o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].playStarted());break;case t.NAMESPACE+"-player-close-overlay":p.adUnit&&e.data.adUnitId&&(o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].closeOverlay());break;case t.NAMESPACE+"-player-abort":p.adUnit&&e.data.adUnitId&&(o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].abort());break;case t.NAMESPACE+"-vast-no-inventory":o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].vastNoInventory();break;case t.NAMESPACE+"-vast-ready":case t.NAMESPACE+"-vpaid-ready":o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].vastPlayerReady();break;case t.NAMESPACE+"-vast-error":o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].vastError();break;case t.NAMESPACE+"-need-optin":p.needOptIn=!0,p.adUnit&&e.data.adUnitId&&(o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].showOptIn());break;case t.NAMESPACE+"-optin":if(p.optinCalled||(p.inFrame?p.registSafeframeStatusChange():(h.addEl(window,"scroll",p.scrollChanged),h.addEl(window,"resize",p.resized)),p.optinCalled=!0),p.adUnit)if(void 0===e.data.adUnitId)for(var o in p.adUnit)void 0!==p.adUnit[o]&&p.adUnit[o].optInSuccess(!1);else o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].optInSuccess(!0);break;case t.NAMESPACE+"-mediation-no-inventry":if(!p.adUnit)return;var s=null,r=null;if(1==Object.keys(p.adUnit).length)s=Object.keys(p.adUnit)[0],void 0!==p.adUnit[s]&&p.adUnit[s].showNextAd();else if(e.data.unitId)(s=e.data.unitId)&&void 0!==p.adUnit[s]&&p.adUnit[s].showNextAd();else if(e.data.adnwUnitId&&(r=e.data.adnwUnitId))for(var o in p.adUnit)if(p[o].adnwUnitId==r){p.adUnit[s].showNextAd();break}break;case t.NAMESPACE+"-over-frame-ready":o=e.data.adUnitId,p.parentWindowWidth=e.data.winWidth,p.parentWindowHeight=e.data.winHeight,void 0!==p.adUnit[o]&&(p.adUnit[o].busterReady=!0);break;case t.NAMESPACE+"-over-frame-visible":o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].onVisible(e.data.visibility);break;case t.NAMESPACE+"-over-frame-hidden":o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].offVisible(e.data.visibility);break;case t.NAMESPACE+"-over-frame-document-state":o=e.data.adUnitId,i=e.data.frameId,"complete"==e.data.state?void 0!==p.adUnit[o]&&p.adUnit[o].onDocumentComplete():setTimeout((function(){window.top.postMessage({type:t.NAMESPACE+"-over-frame-document-state-request",adUnitId:o,frameId:i},"*")}),200);break;case t.NAMESPACE+"-over-frame-load-completed":p.busterEmbeded=!0,p.parentWidth=e.data.parentWidth,p.parentHeight=e.data.parentHeight,p.parentWindowWidth=e.data.windowWidth,p.parentWindowHeight=e.data.windowHeight;break;case t.NAMESPACE+"-over-frame-size":if(o=e.data.adUnitId,void 0!==p.adUnit[o]){var d=p.adUnit[o];if(p.adUnit[o]=null,delete p.adUnit[o],d.width,0<(""+d.width).indexOf("%"))try{var l=parseInt(d.width.replace("%",""));100<l&&(l=100),d.width=e.data.parentWidth*l/100,d.updateParentFrameSize=!0,(d.width>e.data.windowWidth||d.width>e.data.windowHeight)&&(d.width=e.data.windowWidth>e.data.windowHeight?e.data.windowHeight:e.data.windowWidth)}catch(e){}else(d.width>e.data.windowWidth||d.width>e.data.windowHeight)&&(d.width=e.data.windowWidth>e.data.windowHeight?e.data.windowHeight:e.data.windowWidth,d.updateParentFrameSize=!0);p.parentWidth=e.data.parentWidth,p.parentHeight=e.data.parentHeight,p.parentWindowWidth=e.data.windowWidth,p.parentWindowHeight=e.data.windowHeight,p.show(d)}break;case t.NAMESPACE+"-over-frame-scroll-start":o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].scrollStartFromFrame(e.data.visibility);break;case t.NAMESPACE+"-over-frame-scroll-end":o=e.data.adUnitId,void 0!==p.adUnit[o]&&p.adUnit[o].scrollEndFromFrame(e.data.visibility);break;case t.NAMESPACE+"-over-frame-orientation-changed":o=e.data.adUnitId}},p.sendCookieWriteReq=function(t){if(t)try{var e=new(window.XDomainRequest?XDomainRequest:XMLHttpRequest);e.open("GET",t),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.withCredentials=!0,e.send()}catch(t){}},p.sendDmpRes=function(t){if(t)try{var e=new(window.XDomainRequest?XDomainRequest:XMLHttpRequest);e.open("GET",p.kbUrl+"?data="+encodeURIComponent(JSON.stringify(t))),e.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),e.withCredentials=!0;try{e.send()}catch(t){}}catch(t){}},p.showNextAdWithId=function(t){t&&p.adUnit&&t&&void 0!==p.adUnit[t]&&p.adUnit[t].showNextAd()},p.passError=function(t,e){t&&p.adUnit&&t&&void 0!==p.adUnit[t]&&p.adUnit[t].callError(e)},p.cssCheck=function(){for(var e=!1,i=document.getElementsByTagName("head")[0],n=i.getElementsByTagName("link"),o=0;o<n.length;o++)if(0<=(""+n[o].href).indexOf(t.BASE_URL+"css/admatrixAd.css")){e=!0;break}if(!e){var a=t.BASE_URL+"css/admatrixAd.css?v=dH36y9VB",s=document.createElement("link");s.href=a,s.rel="stylesheet",s.type="text/css",i.appendChild(s)}},p.isSfError=function(){for(var e=document.getElementsByTagName("script"),i=!1,n=0;n<e.length;n++)if(0<e[n].innerHTML.indexOf("Construction of SafeFrame failed")){console.log("["+t.NAMESPACE+"] safeFrame construction error found. try loading buster frame"),i=!0;break}return i},p.show=function(i){if((i=i||{}).adUnitId=i.adUnitId||Math.random().toString(36).slice(8),void 0!==p.adUnit[i.adUnitId]){console.log("["+t.NAMESPACE+'] adUnit object "'+i.adUnitId+'" is duplicated.'),p.adUnit[i.adUnitId].abort(),delete p.adUnit[i.adUnitId];var n=document.getElementById(t.NAMESPACE+"-m-"+i.adUnitId);n&&n.parentNode.removeChild(n)}void 0===i.inLoadingLoop&&(i.inLoadingLoop=!1);var o=document.getElementById(i.adUnitId);if(o){if(o.innerHTML="",i.inLoadingLoop=!1,p.amp&&(i.safeFrame=!1),p.inFrame&&!p.inDapIF&&!i.safeFrame)try{var a=window.top&&window.top.location.href;if(a&&window.location.href==a){p.inDapIF=!0,p.referrer=window.top.document.referrer;var s,r=window,d=!1;s=window;do{for(var l=s,c=s.parent,u=c.document.getElementsByTagName("iframe"),f=u.length,m=0;m<f;m++)if(u[m].contentWindow===l){p.defaultParentWidth=u[m].width,p.defaultParentHeight=u[m].height,p.parentFrame=u[m];break}if(c==r.top){d=!0;break}s=c}while(!d)}}catch(n){}if(5<p.loadTimeoutCount/1e3)return console.log("["+t.NAMESPACE+"] frame resource loading timeout."),void(i.onError&&i.onError({detail:"["+t.NAMESPACE+"] frame resource loading timeout."},i.adUnitId));if(i.frameId=i.adUnitId+"-"+Math.random().toString(36).slice(8),i.inLoadingLoop=!1,!i.inLoadingLoop){if(void 0!==i.width&&(i.width,0<(""+i.width).indexOf("%")))try{var g=parseInt(i.width.replace("%",""));if(100<g&&(g=100),p.inFrame&&p.inDapIF)return window.top.postMessage({type:t.NAMESPACE+"-over-frame-request-size",adUnitId:i.adUnitId},"*"),void(p.adUnit[i.adUnitId]=i);var v=o.parentNode.clientWidth;try{var y=window.getComputedStyle(o.parentNode),w=y.getPropertyValue("padding-right");""!=w&&(v-=parseInt(w.replace("px","")));var E=y.getPropertyValue("padding-left");""!=E&&(v-=parseInt(E.replace("px","")))}catch(n){}i.width=v*g/100;var b=h.getWindowHeight();(i.width>window.innerWidth||i.width>b)&&(i.width=window.innerWidth>b?b:window.innerWidth)}catch(n){console.log("["+t.NAMESPACE+"] width parameter will be ignored because it is not valid int."),delete i.width}if(void 0!==i.inFrame&&i.inFrame){if(delete i.inFrame,i.type){var I=i.type;if(void 0!==e[I]&&(void 0===e[I].full&&(e[I].full=!1),void 0===e[I].expand&&(e[I].expand=!1),void 0===e[I].reload&&(e[I].reload=!1),void 0===i.width&&e[I].full?(b=h.getWindowHeight(),window.innerWidth>b?i.width=b||e[I].w:i.width=window.innerWidth||e[I].w):i.width=i.width||e[I].w,void 0===i.expandable&&(i.expandable=!0),void 0===i.height&&(e[I].expand&&i.expandable?i.height=e[I].h*i.width/e[I].w:i.height=i.height||e[I].h),!e[I].expand&&(i.width<e[I].w||i.height<e[I].h)))return void i.onError({detail:"["+t.NAMESPACE+"] container size is too small."},i.adUnitId)}var A=document.createElement("iframe");A.id=t.NAMESPACE+"-replacing-frame-"+i.adUnitId,A.src="javascript:\"<html><body style='background:transparent'></body></html>\"",A.setAttribute("scrolling","no"),A.setAttribute("marginwidth","0"),A.setAttribute("marginheight","0"),A.setAttribute("frameborder","no"),A.setAttribute("allowfullscreen","false"),A.setAttribute("style","margin: 0 auto; padding: 0; border: none; outline: none; position: relative; width: "+i.width+"px; height: "+i.height+"px;"),o.appendChild(A);try{i.calledInFrameOption=!0,i.zeroSizeWhenPassBack=!0;var S="";S+="<!DOCTYPE html><html>",S+='<head><script type="text/javascript" src="'+t.BASE_API_URL+'admatrixAds.js" ><\/script></head>',S+='<body style="margin: 0; padding: 0;">',S+='<div id="'+i.adUnitId+'"></div>',S+='<script type="text/javascript">AdmatrixAds.show('+JSON.stringify(i)+")<\/script>",S+="</body>",S+="</html>";var T=A.contentDocument?A.contentDocument:A.contentWindow.document;T.open(),T.write(S),T.close()}catch(n){i.onError&&i.onError({detail:"["+t.NAMESPACE+"] inFrame process not succeeded."},i.adUnitId)}return}}if(void 0===i.keepSizeWhenPassBack&&(i.keepSizeWhenPassBack=!1),void 0===i.zeroSizeWhenPassBack&&(i.zeroSizeWhenPassBack=!1),p.cssCheck(),void(p.loadTimeoutCount=0)!==i.overlayParam&&p.setOverlayParam(i.adUnitId,i.frameId,i.overlayParam),p.sfReady){var x=document.getElementById("sf_align");x||((x=document.createElement("div")).id="sf_align",x.cssClass="sf",x.style.margin="0",x.style.padding="0",document.body.appendChild(x)),x.appendChild(o)}var k=new p(i);if(k.init()){if(p.inFrame&&i.safeFrame&&(p.registSafeframeStatusChange(k),!p.inDapIF&&void 0!==p.sfExt&&void 0!==p.sfExt.expand))try{var U=p.safeFrameGeom();i.width>U.w&&(p.defaultGeom=U,p.safeFrameExpand({r:i.width-U.w,b:i.height-U.h,push:!0}))}catch(n){console.log("["+t.NAMESPACE+"] safeFrame expand failed")}k.showAd()}p.adUnit[i.adUnitId]=k}else i.onError&&i.onError({detail:"["+t.NAMESPACE+"] adUnit element is not placed."},i.adUnitId)},p.setOverlayParam=function(e,i,n){p.inFrame&&window.top.postMessage({type:t.NAMESPACE+"-over-frame-overlayParamUpdate",adUnitId:e,frameId:i,overlayParam:n},"*"),p.overlayParam[e]=n},p.registSafeframeStatusChange=function(e){if(void 0===e){for(var i in p.adUnit)if(void 0!==p.adUnit[i]&&p.adUnit[i].conf.safeFrame){e=p.adUnit[i];try{p.sfExt.register(e.conf.width,e.conf.height,h.proxy(e.updateViewable,e))}catch(n){void 0!==e.conf.onError&&(e.abort(),e.conf.onError({detail:"["+t.NAMESPACE+"] Exception or no safeframes available: "+n.message},i))}}}else try{p.sfExt.register(e.conf.width,e.conf.height,h.proxy(e.updateViewable,e))}catch(i){if(void 0!==e.conf.onError)return e.abort(),void e.conf.onError({detail:"["+t.NAMESPACE+"] Exception or no safeframes available: "+i.message},e.conf.adUnitId)}},p.checkSafeFrameSupport=function(t){var e=p.sfExt.supports();return e&&e[t]},p.safeFrameGeom=function(){var t=p.sfExt.geom();return t&&t.self},p.safeFrameWindowGeom=function(){var t=p.sfExt.geom();return t&&t.win},p.safeFrameExpand=function(e){p.checkSafeFrameSupport("exp-push")?p.sfExt.expand(e):console.log("["+t.NAMESPACE+"] expand not supported in safeFrame.")},p.isCookieBaked=function(){var t=document.cookie;return!!/optout/i.test(t)||/uid/i.test(t)},p.pageVisibilityChanged=function(){void 0!==document.visibilityState&&p.adUnit&&0<Object.keys(p.adUnit).length&&Object.keys(p.adUnit).forEach((function(t){p.adUnit[t].visibilityChanged&&p.adUnit[t].visibilityChanged()}),p.adUnit)},p.scrollChanged=function(t){if(!h.isFullScreen()&&(void 0===p.ignoreScroll||!p.ignoreScroll)&&p.adUnit&&0<Object.keys(p.adUnit).length){var e=!1;void 0!==p.scrollTimeout?(clearTimeout(p.scrollTimeout),p.scrollTimeout=void 0):e=!0,p.scrollTimeout=setTimeout((function(){p.scrollEnd()}),300),Object.keys(p.adUnit).forEach((function(t){e&&p.adUnit[t].scrollStart&&p.adUnit[t].scrollStart(),p.adUnit[t].visibilityChanged&&p.adUnit[t].visibilityChanged()}),p.adUnit)}},p.inviewed=function(t){p.adUnit&&0<Object.keys(p.adUnit).length&&Object.keys(p.adUnit).forEach((function(t){"VISIBLE"==h.getVisibilityByIntersectionObserver(p.adUnit[t])&&p.adUnit[t].visibilityChanged()}),p.adUnit)},p.fullscreenchanged=function(){var t=h.isFullScreen();p.adUnit&&0<Object.keys(p.adUnit).length&&Object.keys(p.adUnit).forEach((function(e){p.adUnit[e].fullscreenchanged(t)}),p.adUnit),p.ignoreScroll=!!t},p.scrollEnd=function(t){void 0!==p.ignoreScroll&&p.ignoreScroll||p.adUnit&&0<Object.keys(p.adUnit).length&&(void 0!==p.scrollTimeout&&(clearTimeout(p.scrollTimeout),p.scrollTimeout=void 0),Object.keys(p.adUnit).forEach((function(t){p.adUnit[t].scrollEnd&&p.adUnit[t].scrollEnd()}),p.adUnit))},p.resized=function(t){h.isFullScreen()||p.adUnit&&0<Object.keys(p.adUnit).length&&Object.keys(p.adUnit).forEach((function(t){p.adUnit[t].visibilityChanged&&p.adUnit[t].visibilityChanged()}),p.adUnit)},p.ampIntersectionChanged=function(t){p.currentIntersection=t,p.adUnit&&0<Object.keys(p.adUnit).length&&Object.keys(p.adUnit).forEach((function(t){p.adUnit[t].calcIntersection()}),p.adUnit)},p.onload=function(){if(!p.loaded){var t=window,e=document;p.amp=!1,p.os=h.isIOS()?1:2,1==p.os?p.osVersion=h.iosVerStr():p.osVersion=h.getAndroidVersion(),p.osVersion||(p.osVersion=0);var i,n,o=t.admatrixParam||{};if(void 0!==o.amp&&(p.amp=o.amp),p.loaded=!0,p.inFrame=t.top!==t,p.inFrame)try{e.body.style.margin="0",e.body.style.padding="0"}catch(t){}if(p.amp)return p.currentIntersection=window.context.initialIntersection,void 0!==window.context&&void 0!==window.context.observeIntersection&&window.context.observeIntersection((function(t){t.forEach((function(t){p.ampIntersectionChanged(t)}))})),void(p.inFrame=!1);if(p.referrer="",p.location="",p.inDapIF=!1,p.ignoreScroll=!1,p.inFrame){if(!(p.defaultOrientation=null)===("undefined"!=typeof inDapIF&&inDapIF)){p.inDapIF=!0;try{var a,s=window,r=!1;a=window;do{for(var d=a,l=a.parent,c=l.document.getElementsByTagName("iframe"),u=c.length,f=0;f<u;f++)if(c[f].contentWindow===d){p.defaultParentWidth=c[f].width,p.defaultParentHeight=c[f].height,p.parentFrame=c[f];break}if(l==s.top){r=!0;break}a=l}while(!r);t.top&&(p.referrer=window.top.document.referrer,p.location=window.top.location.href)}catch(t){}}}else p.defaultOrientation=h.getOrientation(),h.addEl(t,"scroll",p.scrollChanged),h.addEl(t,"resize",p.resized),h.addEl(t,"inview",p.inviewed),h.addEl(e,"webkitfullscreenchange",p.fullscreenchanged),h.addEl(e,"fullscreenchange",p.fullscreenchanged),h.addEl(e,"mozfullscreenchange",p.fullscreenchanged),h.addEl(e,"msfullscreenchange",p.fullscreenchanged),void 0!==document.hidden?(i="hidden",n="visibilitychange"):void 0!==document.msHidden?(i="msHidden",n="msvisibilitychange"):void 0!==document.webkitHidden&&(i="webkitHidden",n="webkitvisibilitychange"),void 0!==document[i]&&h.addEl(document,n,p.pageVisibilityChanged),p.referrer=window.document.referrer,p.location=window.location.href,p.parentFrame=null;h.addEl(t,"message",p.receiveMessage),p.needOptIn=!0}},window.AdmatrixAds||(window.AdmatrixAds=p),p.adUnit||(p.adUnit={}),p.overlayParam||(p.overlayParam={}),p.extPlayerArgs||(p.extPlayerArgs={}),p.loadTimeoutCount=0,p.onload()}();var n={load:function(t,e,i){var o=n.getDivElem(t);o&&n.createAdmatrixAdsElem(t,e,o,i)},getDivElem:function(t){for(var e=document.getElementsByTagName("div"),i=e.length,n=null,o=0;o<i;o++)if(""!=e[o].id&&0<e[o].id.indexOf(t)){var a=e[o].getAttribute("used");if(null!=a&&""!=a)continue;e[o].setAttribute("used","1"),n=e[o];break}return n},getScriptElem:function(t){for(var e=document.getElementsByTagName("script"),i=e.length,n=null,o=0;o<i;o++)if(""!=e[o].src&&0<e[o].src.indexOf(t)){var a=e[o].getAttribute("used");if(null!=a&&""!=a)continue;e[o].setAttribute("used","1"),n=e[o];break}return n},createAdmatrixAdsElem:function(t,e,i){var n=document.getElementById(t);n||((n=document.createElement("div")).id=t,n.style="position: relative; top: 0px; left: 0px; margin: 0px; padding: 0px; display: inline-block; width: "+i.style.width+"; height: "+i.style.height+";",i.appendChild(n)),AdmatrixAds.show(e),AdmatrixAds.resized(t)}};window.AdmatrixAdsLoader=n}n.load("${AD_UNIT_ID}",JSON.parse("${AD_LOADER_PARAM}"),JSON.parse("${TAG_MANAGE_PARAM}"))},function(t,e){!function(){"use strict";if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}});else{var t=window.document,e=[];n.prototype.THROTTLE_TIMEOUT=100,n.prototype.POLL_INTERVAL=null,n.prototype.USE_MUTATION_OBSERVER=!0,n.prototype.observe=function(t){if(!this._observationTargets.some((function(e){return e.element==t}))){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(),this._checkForIntersections()}},n.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter((function(e){return e.element!=t})),this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())},n.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorIntersections(),this._unregisterInstance()},n.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},n.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter((function(t,e,i){if("number"!=typeof t||isNaN(t)||t<0||1<t)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==i[e-1]}))},n.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map((function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}}));return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},n.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(o(window,"resize",this._checkForIntersections,!0),o(t,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),this._domObserver.observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))},n.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,a(window,"resize",this._checkForIntersections,!0),a(t,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))},n.prototype._checkForIntersections=function(){var t=this._rootIsInDom(),e=t?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(n){var o=n.element,a=s(o),r=this._rootContainsTarget(o),d=n.entry,h=t&&r&&this._computeTargetAndRootIntersection(o,e),l=n.entry=new i({time:window.performance&&performance.now&&performance.now(),target:o,boundingClientRect:a,rootBounds:e,intersectionRect:h});d?t&&r?this._hasCrossedThreshold(d,l)&&this._queuedEntries.push(l):d&&d.isIntersecting&&this._queuedEntries.push(l):this._queuedEntries.push(l)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)},n.prototype._computeTargetAndRootIntersection=function(e,i){if("none"!=window.getComputedStyle(e).display){for(var n,o,a,r,h,l,c,p,u=s(e),f=d(e),m=!1;!m;){var g=null,v=1==f.nodeType?window.getComputedStyle(f):{};if("none"==v.display)return;if(f==this.root||f==t?(m=!0,g=i):f!=t.body&&f!=t.documentElement&&"visible"!=v.overflow&&(g=s(f)),g&&(n=g,o=u,a=Math.max(n.top,o.top),r=Math.min(n.bottom,o.bottom),h=Math.max(n.left,o.left),p=r-a,!(u=0<=(c=(l=Math.min(n.right,o.right))-h)&&0<=p&&{top:a,bottom:r,left:h,right:l,width:c,height:p})))break;f=d(f)}return u}},n.prototype._getRootRect=function(){var e;if(this.root)e=s(this.root);else{var i=t.documentElement,n=t.body;e={top:0,left:0,right:i.clientWidth||n.clientWidth,width:i.clientWidth||n.clientWidth,bottom:i.clientHeight||n.clientHeight,height:i.clientHeight||n.clientHeight}}return this._expandRectByRootMargin(e)},n.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map((function(e,i){return"px"==e.unit?e.value:e.value*(i%2?t.width:t.height)/100})),i={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return i.width=i.right-i.left,i.height=i.bottom-i.top,i},n.prototype._hasCrossedThreshold=function(t,e){var i=t&&t.isIntersecting?t.intersectionRatio||0:-1,n=e.isIntersecting?e.intersectionRatio||0:-1;if(i!==n)for(var o=0;o<this.thresholds.length;o++){var a=this.thresholds[o];if(a==i||a==n||a<i!=a<n)return!0}},n.prototype._rootIsInDom=function(){return!this.root||r(t,this.root)},n.prototype._rootContainsTarget=function(e){return r(this.root||t,e)},n.prototype._registerInstance=function(){e.indexOf(this)<0&&e.push(this)},n.prototype._unregisterInstance=function(){var t=e.indexOf(this);-1!=t&&e.splice(t,1)},window.IntersectionObserver=n,window.IntersectionObserverEntry=i}function i(t){this.time=t.time,this.target=t.target,this.rootBounds=t.rootBounds,this.boundingClientRect=t.boundingClientRect,this.intersectionRect=t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0},this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,i=e.width*e.height,n=this.intersectionRect,o=n.width*n.height;this.intersectionRatio=i?Number((o/i).toFixed(4)):this.isIntersecting?1:0}function n(t,e){var i,n,o,a=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(a.root&&1!=a.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(i=this._checkForIntersections.bind(this),n=this.THROTTLE_TIMEOUT,o=null,function(){o=o||setTimeout((function(){i(),o=null}),n)}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(a.rootMargin),this.thresholds=this._initThresholds(a.threshold),this.root=a.root||null,this.rootMargin=this._rootMarginValues.map((function(t){return t.value+t.unit})).join(" ")}function o(t,e,i,n){"function"==typeof t.addEventListener?t.addEventListener(e,i,n||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,i)}function a(t,e,i,n){"function"==typeof t.removeEventListener?t.removeEventListener(e,i,n||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,i)}function s(t){var e;try{e=t.getBoundingClientRect()}catch(t){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function r(t,e){for(var i=e;i;){if(i==t)return!0;i=d(i)}return!1}function d(t){var e=t.parentNode;return e&&11==e.nodeType&&e.host?e.host:e&&e.assignedSlot?e.assignedSlot.parentNode:e}}()},function(t,e){t.exports={NAMESPACE:"admatrix",BASE_URL:"http://lib-3pas.admatrix.jp/dsp/",BASE_API_URL:"http://lib-3pas.admatrix.jp/dsp/js/",BASE_STATIC_URL:"http://lib-3pas.admatrix.jp/dsp/"}}]);